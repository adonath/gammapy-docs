{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/master?urlpath=lab/tree/analysis_mwl.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[analysis_mwl.ipynb](../_static/notebooks/analysis_mwl.ipynb) |\n",
    "[analysis_mwl.py](../_static/notebooks/analysis_mwl.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Joint modeling, fitting, and serialization\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This tutorial illustrates how to perfom a joint modeling and fitting of the Crab Nebula spectrum using different datasets.\n",
    "We look at the gamma-ray emission from the Crab nebula between 10 GeV and 100 TeV.\n",
    "The spectral parameters are optimized by combining a 3D analysis of Fermi-LAT data, a ON/OFF spectral analysis of HESS data, and flux points from HAWC.\n",
    "\n",
    "In this tutorial we are going to use pre-made datasets. We prepared maps of the Crab region as seen by Fermi-LAT using the same event selection than the [3FHL catalog](https://arxiv.org/abs/1702.00664) (7 years of data with energy from 10 GeV to 2 TeV). For the HESS ON/OFF analysis we used two observations from the [first public data release](https://arxiv.org/abs/1810.04516) with a significant signal from energy of about 600 GeV to 10 TeV. These observations have an offset of 0.5° and a zenith angle of 45-48°. The HAWC flux points data are taken from a [recent analysis](https://arxiv.org/pdf/1905.12518.pdf) based on 2.5 years of data with energy between 300 Gev and 300 TeV. \n",
    "\n",
    "More details on how to prepare datasets with the high and low level interfaces are available in these tutorials: \n",
    "\n",
    "- https://docs.gammapy.org/0.14/notebooks/fermi_lat.html\n",
    "- https://docs.gammapy.org/dev/notebooks/hess.html\n",
    "- https://docs.gammapy.org/dev/notebooks/spectrum_analysis.html\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "from astropy import units as u\n",
    "import matplotlib.pyplot as plt\n",
    "from gammapy.modeling import Fit, Datasets\n",
    "from gammapy.spectrum import (\n",
    "    FluxPoints,\n",
    "    FluxPointsEstimator,\n",
    "    FluxPointsDataset,\n",
    "    SpectrumDatasetOnOff,\n",
    ")\n",
    "from gammapy.maps import MapAxis\n",
    "from pathlib import Path"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Data and models files\n",
    "\n",
    "\n",
    "The datasets serialization produce YAML files listing the datasets and models. In the following cells we show an example containning only the Fermi-LAT dataset and the Crab model. \n",
    "\n",
    "Fermi-LAT-3FHL_datasets.yaml:\n",
    "\n",
    "```yaml\n",
    "datasets:\n",
    "- name: Fermi-LAT\n",
    "  type: MapDataset\n",
    "  likelihood: cash\n",
    "  models:\n",
    "- Crab Nebula\n",
    "  background: background\n",
    "  filename: $GAMMAPY_DATA/fermi-3fhl-crab/Fermi-LAT-3FHL_data_Fermi-LAT.fits\n",
    "```\n",
    "\n",
    "We used as model a point source with a log-parabola spectrum. The initial parameters were taken from the latest Fermi-LAT catalog [4FGL](https://arxiv.org/abs/1902.10045), then we have re-optimized the spectral parameters for our dataset in the 10 GeV - 2 TeV energy range (fixing the source position).\n",
    "\n",
    "Fermi-LAT-3FHL_models.yaml:\n",
    "\n",
    "```yaml\n",
    "components:\n",
    "- name: Crab Nebula\n",
    "  type: SkyModel\n",
    "  spatial:\n",
    "    type: PointSpatialModel\n",
    "    frame: icrs\n",
    "    parameters:\n",
    "    - name: lon_0\n",
    "      value: 83.63310241699219\n",
    "      unit: deg\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: true\n",
    "    - name: lat_0\n",
    "      value: 22.019899368286133\n",
    "      unit: deg\n",
    "      min: -90.0\n",
    "      max: 90.0\n",
    "      frozen: true\n",
    "  spectral:\n",
    "    type: LogParabolaSpectralModel\n",
    "    parameters:\n",
    "    - name: amplitude\n",
    "      value: 0.3415498620816483\n",
    "      unit: cm-2 s-1 TeV-1\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: false\n",
    "    - name: reference\n",
    "      value: 5.054833602905273e-05\n",
    "      unit: TeV\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: true\n",
    "    - name: alpha\n",
    "      value: 2.510798031388936\n",
    "      unit: ''\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: false\n",
    "    - name: beta\n",
    "      value: -0.022476498188855533\n",
    "      unit: ''\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: false\n",
    "- name: background\n",
    "  type: BackgroundModel\n",
    "  parameters:\n",
    "  - name: norm\n",
    "    value: 0.9544383244743555\n",
    "    unit: ''\n",
    "    min: 0.0\n",
    "    max: .nan\n",
    "    frozen: false\n",
    "  - name: tilt\n",
    "    value: 0.0\n",
    "    unit: ''\n",
    "    min: .nan\n",
    "    max: .nan\n",
    "    frozen: true\n",
    "  - name: reference\n",
    "    value: 1.0\n",
    "    unit: TeV\n",
    "    min: .nan\n",
    "    max: .nan\n",
    "    frozen: true\n",
    "\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Reading  different datasets\n",
    "\n",
    "\n",
    "### Fermi-LAT 3FHL: map dataset for 3D analysis\n",
    "For now we let's use the datasets serialization only to read the 3D `MapDataset` associated to Fermi-LAT 3FHL data and models."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING: FITSFixedWarning: 'datfix' made the change 'Set DATE-REF to '1858-11-17' from MJD-REF'. [astropy.wcs.wcs]\n"
     ]
    }
   ],
   "source": [
    "path = \"$GAMMAPY_DATA/fermi-3fhl-crab/Fermi-LAT-3FHL\"\n",
    "filedata = Path(path + \"_datasets.yaml\")\n",
    "filemodel = Path(path + \"_models.yaml\")\n",
    "datasets = Datasets.read(filedata=filedata, filemodel=filemodel)\n",
    "dataset_fermi = datasets[0]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We get the Crab model in order to share it with the other datasets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabolaSpectralModel\n",
      "\n",
      "   name     value    error      unit      min max frozen\n",
      "--------- ---------- ----- -------------- --- --- ------\n",
      "amplitude  3.415e-01   nan cm-2 s-1 TeV-1 nan nan  False\n",
      "reference  5.055e-05   nan            TeV nan nan   True\n",
      "    alpha  2.511e+00   nan                nan nan  False\n",
      "     beta -2.248e-02   nan                nan nan  False\n"
     ]
    }
   ],
   "source": [
    "crab_model = dataset_fermi.models[\"Crab Nebula\"]\n",
    "crab_spec = crab_model.spectral_model\n",
    "print(crab_spec)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### HESS-DL3: 1D ON/OFF dataset for spectral fitting\n",
    "\n",
    "The ON/OFF datasets can be read from PHA files following the [OGIP standards](https://heasarc.gsfc.nasa.gov/docs/heasarc/ofwg/docs/spectra/ogip_92_007/node5.html).\n",
    "We read the PHA files from each observation, and compute a stacked dataset for simplicity.\n",
    "Then the Crab spectral model previously defined is added to the dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "datasets = []\n",
    "\n",
    "for obs_id in [23523, 23526]:\n",
    "    dataset = SpectrumDatasetOnOff.from_ogip_files(\n",
    "        f\"$GAMMAPY_DATA/joint-crab/spectra/hess/pha_obs{obs_id}.fits\"\n",
    "    )\n",
    "    datasets.append(dataset)\n",
    "\n",
    "dataset_hess = Datasets(datasets).stack_reduce()\n",
    "dataset_hess.name = \"HESS\"\n",
    "dataset_hess.models = crab_model"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### HAWC: 1D dataset for flux point fitting\n",
    "\n",
    "The HAWC flux point are taken from https://arxiv.org/pdf/1905.12518.pdf. Then these flux points are read from a pre-made FITS file and passed to a `FluxPointsDataset` together with the source spectral model.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "# read flux points from https://arxiv.org/pdf/1905.12518.pdf\n",
    "filename = \"$GAMMAPY_DATA/hawc_crab/HAWC19_flux_points.fits\"\n",
    "flux_points_hawc = FluxPoints.read(filename)\n",
    "dataset_hawc = FluxPointsDataset(crab_model, flux_points_hawc, name=\"HAWC\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Datasets serialization\n",
    "\n",
    "The `datasets` object contains each dataset previously defined. \n",
    "It can be saved on disk as datasets.yaml, models.yaml, and several data files specific to each dataset. Then the `datasets` can be rebuild later from these files."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "datasets = Datasets([dataset_fermi, dataset_hess, dataset_hawc])\n",
    "path = Path(\"crab-3datasets\")\n",
    "path.mkdir(exist_ok=True)\n",
    "\n",
    "datasets.write(path=path, prefix=\"crab_10GeV_100TeV\", overwrite=True)\n",
    "filedata = path / \"crab_10GeV_100TeV_datasets.yaml\"\n",
    "filemodel = path / \"crab_10GeV_100TeV_models.yaml\"\n",
    "datasets = Datasets.read(filedata=filedata, filemodel=filemodel)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Joint analysis\n",
    "\n",
    "We run the fit on the `Datasets` object that include a dataset for each instrument\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OptimizeResult\n",
      "\n",
      "\tbackend    : minuit\n",
      "\tmethod     : minuit\n",
      "\tsuccess    : True\n",
      "\tmessage    : Optimization terminated successfully.\n",
      "\tnfev       : 862\n",
      "\ttotal stat : -14820.65\n",
      "\n",
      "   name     value     error        unit         min        max    frozen\n",
      "--------- --------- --------- -------------- ---------- --------- ------\n",
      "    lon_0 8.363e+01 0.000e+00            deg        nan       nan   True\n",
      "    lat_0 2.202e+01 0.000e+00            deg -9.000e+01 9.000e+01   True\n",
      "amplitude 3.737e-03 1.296e-05 cm-2 s-1 TeV-1        nan       nan  False\n",
      "reference 5.055e-05 0.000e+00            TeV        nan       nan   True\n",
      "    alpha 1.247e+00 3.364e-04                       nan       nan  False\n",
      "     beta 6.242e-02 8.412e-05                       nan       nan  False\n",
      "     norm 9.785e-01 3.229e-01                 0.000e+00       nan  False\n",
      "     tilt 0.000e+00 0.000e+00                       nan       nan   True\n",
      "reference 1.000e+00 0.000e+00            TeV        nan       nan   True\n",
      "CPU times: user 8.61 s, sys: 66.3 ms, total: 8.68 s\n",
      "Wall time: 8.7 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "fit_joint = Fit(datasets)\n",
    "results_joint = fit_joint.run()\n",
    "print(results_joint)\n",
    "print(results_joint.parameters.to_table())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's display only the parameters of the Crab spectral model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabolaSpectralModel\n",
      "\n",
      "   name     value     error        unit      min max frozen\n",
      "--------- --------- --------- -------------- --- --- ------\n",
      "amplitude 3.737e-03 1.296e-05 cm-2 s-1 TeV-1 nan nan  False\n",
      "reference 5.055e-05 0.000e+00            TeV nan nan   True\n",
      "    alpha 1.247e+00 3.364e-04                nan nan  False\n",
      "     beta 6.242e-02 8.412e-05                nan nan  False\n"
     ]
    }
   ],
   "source": [
    "crab_spec = datasets[0].models[\"Crab Nebula\"].spectral_model\n",
    "crab_spec.parameters.covariance = results_joint.parameters.get_subcovariance(\n",
    "    crab_spec.parameters\n",
    ")\n",
    "print(crab_spec)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can compute flux points for Fermi-LAT and HESS datasets in order plot them together with the HAWC flux point."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "# compute Fermi-LAT and HESS flux points\n",
    "e_edges = MapAxis.from_bounds(\n",
    "    0.01, 2.0, nbin=6, interp=\"log\", unit=\"TeV\"\n",
    ").edges\n",
    "\n",
    "flux_points_fermi = FluxPointsEstimator(\n",
    "    datasets=[dataset_fermi], e_edges=e_edges, source=\"Crab Nebula\"\n",
    ").run()\n",
    "\n",
    "\n",
    "e_edges = MapAxis.from_bounds(1, 15, nbin=6, interp=\"log\", unit=\"TeV\").edges\n",
    "flux_points_hess = FluxPointsEstimator(\n",
    "    datasets=[dataset_hess], e_edges=e_edges\n",
    ").run()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now, Let's plot the Crab spectrum fitted and the flux points of each instrument.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# display spectrum and flux points\n",
    "energy_range = [0.01, 120] * u.TeV\n",
    "plt.figure(figsize=(8, 6))\n",
    "ax = crab_spec.plot(energy_range=energy_range, energy_power=2, label=\"Model\")\n",
    "crab_spec.plot_error(ax=ax, energy_range=energy_range, energy_power=2)\n",
    "flux_points_fermi.plot(ax=ax, energy_power=2, label=\"Fermi-LAT\")\n",
    "flux_points_hess.plot(ax=ax, energy_power=2, label=\"HESS\")\n",
    "flux_points_hawc.plot(ax=ax, energy_power=2, label=\"HAWC\")\n",
    "plt.legend();"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
