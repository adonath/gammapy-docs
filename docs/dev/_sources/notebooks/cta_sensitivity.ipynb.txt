{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/master?urlpath=lab/tree/cta_sensitivity.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/tutorials).\n",
    "- **Source files:**\n",
    "[cta_sensitivity.ipynb](../_static/notebooks/cta_sensitivity.ipynb) |\n",
    "[cta_sensitivity.py](../_static/notebooks/cta_sensitivity.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Estimation of the CTA point source sensitivity"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Introduction\n",
    "\n",
    "This notebook explains how to estimate the CTA sensitivity for a point-like IRF at a fixed zenith angle and fixed offset using the full containement IRFs distributed for the CTA 1DC. The significativity is computed for a 1D analysis (On-OFF regions) and the LiMa formula. \n",
    "\n",
    "We use here an approximate approach with an energy dependent integration radius to take into account the variation of the PSF. We will first determine the 1D IRFs including a containment correction. \n",
    "\n",
    "We will be using the following Gammapy class:\n",
    "\n",
    "* `~gammapy.spectrum.SensitivityEstimator`"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Setup\n",
    "As usual, we'll start with some setup ..."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import astropy.units as u\n",
    "from astropy.coordinates import Angle, SkyCoord\n",
    "from gammapy.irf import load_cta_irfs\n",
    "from gammapy.spectrum import (\n",
    "    SensitivityEstimator,\n",
    "    SpectrumDatasetMaker,\n",
    "    SpectrumDataset,\n",
    "    SpectrumDatasetOnOff,\n",
    ")\n",
    "from gammapy.data import Observation\n",
    "from regions import CircleSkyRegion\n",
    "from gammapy.maps import MapAxis"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Define analysis region and energy binning\n",
    "\n",
    "Here we assume a source at 0.5 degree from pointing position. We perform a simple energy independent extraction for now with a radius of 0.1 degree."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "center = SkyCoord(\"0 deg\", \"0.5 deg\")\n",
    "region = CircleSkyRegion(center=center, radius=0.1 * u.deg)\n",
    "\n",
    "e_reco = MapAxis.from_energy_bounds(\"0.03 TeV\", \"30 TeV\", nbin=20)\n",
    "e_true = MapAxis.from_energy_bounds(\"0.01 TeV\", \"100 TeV\", nbin=100)\n",
    "\n",
    "empty_dataset = SpectrumDataset.create(\n",
    "    e_reco=e_reco.edges, e_true=e_true.edges, region=region\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Load IRFs and prepare dataset\n",
    "\n",
    "We extract the 1D IRFs from the full 3D IRFs provided by CTA. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING: AstropyDeprecationWarning: The truth value of a Quantity is ambiguous. In the future this will raise a ValueError. [astropy.units.quantity]\n"
     ]
    }
   ],
   "source": [
    "irfs = load_cta_irfs(\n",
    "    \"$GAMMAPY_DATA/cta-1dc/caldb/data/cta/1dc/bcf/South_z20_50h/irf_file.fits\"\n",
    ")\n",
    "\n",
    "pointing = SkyCoord(\"0 deg\", \"0 deg\")\n",
    "obs = Observation.create(pointing=pointing, irfs=irfs, livetime=\"5 h\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "spectrum_maker = SpectrumDatasetMaker(\n",
    "    selection=[\"aeff\", \"edisp\", \"background\"]\n",
    ")\n",
    "dataset = spectrum_maker.run(empty_dataset, obs)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we correct for the energy dependent region size:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "containment = 0.68\n",
    "\n",
    "# correct effective area\n",
    "dataset.aeff.data.data *= containment\n",
    "\n",
    "# correct background estimation\n",
    "on_radii = obs.psf.containment_radius(\n",
    "    energy=e_reco.center, theta=0.5 * u.deg, fraction=containment\n",
    ")[0]\n",
    "factor = (1 - np.cos(on_radii)) / (1 - np.cos(region.radius))\n",
    "dataset.background.data *= factor.value"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "And finally define a `SpectrumDatasetOnOff` with an alpha of `0.2`. The off counts are created from the background model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "dataset_on_off = SpectrumDatasetOnOff.from_spectrum_dataset(\n",
    "    dataset=dataset, acceptance=1, acceptance_off=5\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Compute sensitivity\n",
    "\n",
    "We impose a minimal number of expected signal counts of 5 per bin and a minimal significance of 3 per bin. We assume an alpha of 0.2 (ratio between ON and OFF area).\n",
    "We then run the sensitivity estimator."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "sensitivity_estimator = SensitivityEstimator(gamma_min=5, sigma=3)\n",
    "sensitivity_table = sensitivity_estimator.run(dataset_on_off)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Results\n",
    "\n",
    "The results are given as an Astropy table. A column criterion allows to distinguish bins where the significance is limited by the signal statistical significance from bins where the sensitivity is limited by the number of signal counts.\n",
    "This is visible in the plot below."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<i>Table length=20</i>\n",
       "<table id=\"table4786150704\" class=\"table-striped table-bordered table-condensed\">\n",
       "<thead><tr><th>energy</th><th>e2dnde</th><th>excess</th><th>background</th><th>criterion</th></tr></thead>\n",
       "<thead><tr><th>TeV</th><th>erg / (cm2 s)</th><th></th><th></th><th></th></tr></thead>\n",
       "<thead><tr><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>bytes12</th></tr></thead>\n",
       "<tr><td>0.0356551</td><td>9.82318e-12</td><td>199.602</td><td>3611.86</td><td>significance</td></tr>\n",
       "<tr><td>0.0503641</td><td>7.47229e-12</td><td>141.851</td><td>1808.46</td><td>significance</td></tr>\n",
       "<tr><td>0.0711412</td><td>3.33818e-12</td><td>94.608</td><td>792.485</td><td>significance</td></tr>\n",
       "<tr><td>0.10049</td><td>1.83264e-12</td><td>67.225</td><td>392.809</td><td>significance</td></tr>\n",
       "<tr><td>0.141945</td><td>1.33789e-12</td><td>47.1992</td><td>188.424</td><td>significance</td></tr>\n",
       "<tr><td>0.200503</td><td>9.53756e-13</td><td>31.7001</td><td>81.2163</td><td>significance</td></tr>\n",
       "<tr><td>0.283218</td><td>6.48812e-13</td><td>21.7761</td><td>35.9296</td><td>significance</td></tr>\n",
       "<tr><td>0.400056</td><td>5.2388e-13</td><td>15.1912</td><td>15.9406</td><td>significance</td></tr>\n",
       "<tr><td>0.565095</td><td>3.83632e-13</td><td>11.1615</td><td>7.6638</td><td>significance</td></tr>\n",
       "<tr><td>0.798218</td><td>3.36278e-13</td><td>8.29778</td><td>3.60441</td><td>significance</td></tr>\n",
       "<tr><td>1.12751</td><td>2.89526e-13</td><td>6.55694</td><td>1.87455</td><td>significance</td></tr>\n",
       "<tr><td>1.59265</td><td>2.41955e-13</td><td>5.69211</td><td>1.22178</td><td>significance</td></tr>\n",
       "<tr><td>2.24968</td><td>2.1639e-13</td><td>5</td><td>0.782329</td><td>gamma</td></tr>\n",
       "<tr><td>3.17776</td><td>2.30343e-13</td><td>5</td><td>0.499028</td><td>gamma</td></tr>\n",
       "<tr><td>4.48871</td><td>2.7271e-13</td><td>5</td><td>0.340861</td><td>gamma</td></tr>\n",
       "<tr><td>6.34047</td><td>3.57656e-13</td><td>5</td><td>0.202769</td><td>gamma</td></tr>\n",
       "<tr><td>8.95615</td><td>4.65663e-13</td><td>5</td><td>0.0940542</td><td>gamma</td></tr>\n",
       "<tr><td>12.6509</td><td>6.6765e-13</td><td>5</td><td>0.0507529</td><td>gamma</td></tr>\n",
       "<tr><td>17.8699</td><td>7.92891e-13</td><td>5</td><td>0.0300523</td><td>gamma</td></tr>\n",
       "<tr><td>25.2419</td><td>1.12874e-12</td><td>5</td><td>0.0137948</td><td>gamma</td></tr>\n",
       "</table>"
      ],
      "text/plain": [
       "<Table length=20>\n",
       "  energy      e2dnde     excess background  criterion  \n",
       "   TeV    erg / (cm2 s)                                \n",
       " float64     float64    float64  float64     bytes12   \n",
       "--------- ------------- ------- ---------- ------------\n",
       "0.0356551   9.82318e-12 199.602    3611.86 significance\n",
       "0.0503641   7.47229e-12 141.851    1808.46 significance\n",
       "0.0711412   3.33818e-12  94.608    792.485 significance\n",
       "  0.10049   1.83264e-12  67.225    392.809 significance\n",
       " 0.141945   1.33789e-12 47.1992    188.424 significance\n",
       " 0.200503   9.53756e-13 31.7001    81.2163 significance\n",
       " 0.283218   6.48812e-13 21.7761    35.9296 significance\n",
       " 0.400056    5.2388e-13 15.1912    15.9406 significance\n",
       " 0.565095   3.83632e-13 11.1615     7.6638 significance\n",
       " 0.798218   3.36278e-13 8.29778    3.60441 significance\n",
       "  1.12751   2.89526e-13 6.55694    1.87455 significance\n",
       "  1.59265   2.41955e-13 5.69211    1.22178 significance\n",
       "  2.24968    2.1639e-13       5   0.782329        gamma\n",
       "  3.17776   2.30343e-13       5   0.499028        gamma\n",
       "  4.48871    2.7271e-13       5   0.340861        gamma\n",
       "  6.34047   3.57656e-13       5   0.202769        gamma\n",
       "  8.95615   4.65663e-13       5  0.0940542        gamma\n",
       "  12.6509    6.6765e-13       5  0.0507529        gamma\n",
       "  17.8699   7.92891e-13       5  0.0300523        gamma\n",
       "  25.2419   1.12874e-12       5  0.0137948        gamma"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Show the results table\n",
    "sensitivity_table"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Save it to file (could use e.g. format of CSV or ECSV or FITS)\n",
    "# sensitivity_table.write('sensitivity.ecsv', format='ascii.ecsv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAY8AAAEKCAYAAADq59mMAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8li6FKAAAgAElEQVR4nO3dedzVc/7/8cfrqiulzVokVIpESiprKkuyJE0MYUjRZN93Y4svP+swQyMikmyRdSwNUozRRrbBDCEtlFFRaXv9/nifqy6Xc851Ttc553OW5/12O7eu8/mcz+e8XMd1va739nqbuyMiIpKOsqgDEBGRwqPkISIiaVPyEBGRtCl5iIhI2pQ8REQkbUoeIiKSttpRB5ALm222mbdo0SLqMERECsq0adMWuPvm8c6VRPJo0aIFU6dOjToMEZGCYmZfJTqnbisREUmbkoeIiKRNyUNERNKW92MeZtYKuBxo7O5HJjomIoVt5cqVzJ49m+XLl0cdSsmpW7cuzZs3p7y8POVrspo8zOx+4DDgO3ffudLx3sAdQC3gPne/MdE93P0LYLCZPZnsWEZtsQXMn//b402bwrx5WXlLkVI3e/ZsGjZsSIsWLTCzqMMpGe7OwoULmT17Ni1btkz5umx3W40Celc+YGa1gLuAg4F2wAAza2dm7c3s+SqPJlmOL754iSPZcRGpseXLl7PpppsqceSYmbHpppum3eLLasvD3d80sxZVDncF/hNrPWBmjwJ93f0GQitFREqUEkc01uf7HsWA+VbAN5Wez44di8vMNjWzvwG7mtmliY7FuW6ImU01s6nff/99BsMXkVJy8skn8/HHH6/XtXPmzOHII9cNyw4YMIBddtmF22+/nSuvvJIJEyZkKsyci2LAPF6KS7gjlbsvBIZWdyzOdSOAEQCdO3fWjlcixSSH45L33Xffel/brFkznnwyDM3OmzePt99+m6++SrjurqBE0fKYDWxd6XlzYE4Ecayf//0v6ghEJEvjkj///DOHHnooHTp0YOedd+axxx6jR48eaytUjBw5ku23354ePXpwyimncMYZZwAwcOBAzjrrLPbaay9atWq1NmHMmjWLnXcOc4V69erFd999R8eOHZk0aRIDBw5c+7opU6aw11570aFDB7p27cqSJUuYNWsW3bp1o1OnTnTq1Im3334bgDfeeIMePXpw5JFH0rZtW4477jgqdoSNd5/Vq1dz4YUX0qVLF3bZZRfuueeeGn2PKkTR8pgCtDGzlsC3wDHAsRHEkVjTpon/J9xnH/j732GbbXIbk0gpOecceO+99bu2R4/4xzt2hD//OemlL730Es2aNeOFF14AYNGiRQwfPhwIXVDDhg1j+vTpNGzYkP32248OHTqsvXbu3LlMnjyZf//73xx++OG/6q4CePbZZznssMN4L/bfNXLkSABWrFjB0UcfzWOPPUaXLl1YvHgx9erVo0mTJrz66qvUrVuXzz//nAEDBqxNYjNmzOCjjz6iWbNm7L333rz11lt07do17n1GjhxJ48aNmTJlCr/88gt77703vXr1SmtmVTxZbXmY2Vjgn8AOZjbbzAa7+yrgDOBl4BPgcXf/KJtxpG3ePHD/7eP11+Hbb2GPPeD996OOUkQyrH379kyYMIGLL76YSZMm0bhx47Xn3n33Xbp3784mm2xCeXk5Rx111K+uPeKIIygrK6Ndu3bMT6MF9Omnn7LlllvSpUsXABo1akTt2rVZuXIlp5xyCu3bt+eoo4761bhL165dad68OWVlZXTs2JFZs2YlvM8rr7zCQw89RMeOHdl9991ZuHAhn3/+eU2+TUD2Z1sNSHD8ReDFbL43gJn1Afq0bt06Mzfs0QPeegt694Zu3eCpp+CAAzJzbxFZp5oWAslmB73xxnq/7fbbb8+0adN48cUXufTSS+nVq9facxVdQ4lssMEGKb+2MnePO9vp9ttvp2nTprz//vusWbOGunXrxn2vWrVqsWrVqoT3cXf+8pe/cNBBB6UcUyqKujyJuz/n7kMq//VQYzvtBO+8Ay1awMEHw+jRmbu3iERqzpw5bLjhhhx//PFccMEFTJ8+fe25rl27MnHiRP73v/+xatUqxo0bl5H3bNu2LXPmzGHKlCkALFmyhFWrVrFo0SK23HJLysrKGD16NKtXr16v+xx00EEMHz6clStXAvDZZ5/x888/1zjuvC9Pkpe22gomTYLf/Q5OOAFmz4ZLLkn+15CIZE6iccmmTWt02w8++IALL7yQsrIyysvLGT58OBdccAEAW221FZdddhm77747zZo1o127dmTiD9M6derw2GOPceaZZ7Js2TLq1avHhAkTOO200+jfvz9PPPEEPXv2pH79+ut1n5NPPplZs2bRqVMn3J3NN9+c8ePH1zhuS6d5Vag6d+7sWdnPY8UKGDQIxoyBoUPhL3+B2srHIuvjk08+Yccdd4w6jKR++uknGjRowKpVq+jXrx+DBg2iX79+UYeVEfG+/2Y2zd07x3u9ftPVRJ068NBDsPXWcOONYTD90Udhww2jjkxEsuDqq69mwoQJLF++nF69enHEEUdEHVJklDxqqqwMbrghJJAzz4T99oPnnoPN4+7cKCIF7JZbbok6hLxR1APmZtbHzEYsWrQo+2922mlh9tX778Nee8F//5v99xQRiUhRJ4+szLZKpm9feO21kDhatw4D6JUfW2yRmzhERLKsqJNHJPbcMywojEcl3UWkSCh5iIhI2pQ8REQkbUoeIlKw5s6F7t21O3QUlDxEpGANGwaTJ8O112bynsNo27YtBx54IAMGDOCWW27h3nvvpUuXLnTo0IH+/fuzdOlSIJRiP/XUU+nZsyetWrVi4sSJDBo0iB133JGBAweuvWeDBg24+OKL2W233TjggAN499136dGjB61ateLZZ58FSFiCPW+5e9E+gD7AiNatW3tONW0aryZvOC4icX388cdrvz77bPfu3RM/ysri/4iVlSW+5uyzq49hypQp3qFDB1+6dKkvXrzYW7du7TfffLMvWLBg7Wsuv/xyv/POO93d/cQTT/Sjjz7a16xZ4+PHj/eGDRv6zJkzffXq1d6pUyefMWOGu7sD/uKLL7q7+xFHHOEHHnigr1ixwt977z3v0KGDu7v//PPPvmzZMnd3/+yzz3y33XZb32/leqn8/a8ATPUEv1+LuuXhuZ6qW6FqSffzzw9lSz74ILdxiBSprl2hSZOwRhfCv02awO671+y+kydPpm/fvtSrV4+GDRvSp08fAD788EO6detG+/btGTNmDB99tG4XiT59+mBmtG/fnqZNm9K+fXvKysrYaaedmDVrFhDqTvXu3RsIZd+7d+9OeXk57du3X/uaZCXY85FWmOfCoEFw663w8MNw7rlRRyOS96qryA5w6qkwYgTUrRvKzPXvD3ffXbP39QTT7AcOHMj48ePp0KEDo0aN4o1KZd8ryqOXlZX9qlR6WVkZq1atAqC8vHxtufTKr6v8mmQl2PNRUbc88ka7dmEDqZEjE68BEZG0zJ8f6pG+8074NxOD5vvssw/PPfccy5cv56efflq7o+CSJUvYcsstWblyJWPG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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Plot the sensitivity curve\n",
    "t = sensitivity_table\n",
    "\n",
    "is_s = t[\"criterion\"] == \"significance\"\n",
    "plt.plot(\n",
    "    t[\"energy\"][is_s],\n",
    "    t[\"e2dnde\"][is_s],\n",
    "    \"s-\",\n",
    "    color=\"red\",\n",
    "    label=\"significance\",\n",
    ")\n",
    "\n",
    "is_g = t[\"criterion\"] == \"gamma\"\n",
    "plt.plot(\n",
    "    t[\"energy\"][is_g], t[\"e2dnde\"][is_g], \"*-\", color=\"blue\", label=\"gamma\"\n",
    ")\n",
    "\n",
    "plt.loglog()\n",
    "plt.xlabel(f\"Energy ({t['energy'].unit})\")\n",
    "plt.ylabel(f\"Sensitivity ({t['e2dnde'].unit})\")\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We add some control plots showing the expected number of background counts per bin and the ON region size cut (here the 68% containment radius of the PSF)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(0.01, 0.5)"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Plot expected number of counts for signal and background\n",
    "fig, ax1 = plt.subplots()\n",
    "# ax1.plot( t[\"energy\"], t[\"excess\"],\"o-\", color=\"red\", label=\"signal\")\n",
    "ax1.plot(\n",
    "    t[\"energy\"], t[\"background\"], \"o-\", color=\"black\", label=\"blackground\"\n",
    ")\n",
    "\n",
    "ax1.loglog()\n",
    "ax1.set_xlabel(f\"Energy ({t['energy'].unit})\")\n",
    "ax1.set_ylabel(\"Expected number of bkg counts\")\n",
    "\n",
    "ax2 = ax1.twinx()\n",
    "ax2.set_ylabel(f\"ON region radius ({on_radii.unit})\", color=\"red\")\n",
    "ax2.semilogy(t[\"energy\"], on_radii, color=\"red\", label=\"PSF68\")\n",
    "ax2.tick_params(axis=\"y\", labelcolor=\"red\")\n",
    "ax2.set_ylim(0.01, 0.5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercises\n",
    "\n",
    "* Also compute the sensitivity for a 20 hour observation\n",
    "* Compare how the sensitivity differs between 5 and 20 hours by plotting the ratio as a function of energy."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
