{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://static.mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/master?urlpath=lab/tree/catalog.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/docs/tutorials).\n",
    "- **Source files:**\n",
    "[catalog.ipynb](../_static/notebooks/catalog.ipynb) |\n",
    "[catalog.py](../_static/notebooks/catalog.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Source catalogs\n",
    "\n",
    "`~gammapy.catalog` provides convenient access to common gamma-ray source catalogs. E.g. creating a spectral model and spectral points for a given Fermi-LAT catalog and source from the FITS table is tedious, `~gammapy.catalog` has this implemented and makes it easy.\n",
    "\n",
    "In this tutorial you will learn how to:\n",
    "\n",
    "- List available catalogs\n",
    "- Load a catalog\n",
    "- Select a source\n",
    "- Pretty-print the source information\n",
    "- Get source spectral and spatial models\n",
    "- Get flux points (if available)\n",
    "- Get lightcurves (if available)\n",
    "- Access the source catalog table data\n",
    "\n",
    "In this tutorial we will show examples using the following catalogs:\n",
    "\n",
    "- `~gammapy.catalog.SourceCatalogHGPS`\n",
    "- `~gammapy.catalog.SourceCatalogGammaCat`\n",
    "- `~gammapy.catalog.SourceCatalog3FHL`\n",
    "- `~gammapy.catalog.SourceCatalog4FGL`\n",
    "\n",
    "All catalog and source classes work the same, as long as some information is available. E.g. trying to access a lightcurve from a catalog and source that doesn't have that information will return ``None``.\n",
    "\n",
    "Further information is available at `~gammapy.catalog`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:51.488736Z",
     "iopub.status.busy": "2020-11-19T14:16:51.488159Z",
     "iopub.status.idle": "2020-11-19T14:16:51.764755Z",
     "shell.execute_reply": "2020-11-19T14:16:51.763628Z"
    }
   },
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:51.768675Z",
     "iopub.status.busy": "2020-11-19T14:16:51.767793Z",
     "iopub.status.idle": "2020-11-19T14:16:52.716540Z",
     "shell.execute_reply": "2020-11-19T14:16:52.715531Z"
    }
   },
   "outputs": [],
   "source": [
    "import astropy.units as u\n",
    "from gammapy.catalog import CATALOG_REGISTRY"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## List available catalogs\n",
    "\n",
    "`~gammapy.catalog` contains a catalog registry ``CATALOG_REGISTRY``, which maps catalog names (e.g. \"3fhl\") to catalog classes (e.g. ``SourceCatalog3FHL``). "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:52.723002Z",
     "iopub.status.busy": "2020-11-19T14:16:52.722515Z",
     "iopub.status.idle": "2020-11-19T14:16:52.725650Z",
     "shell.execute_reply": "2020-11-19T14:16:52.726147Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[gammapy.catalog.gammacat.SourceCatalogGammaCat,\n",
       " gammapy.catalog.hess.SourceCatalogHGPS,\n",
       " gammapy.catalog.hawc.SourceCatalog2HWC,\n",
       " gammapy.catalog.fermi.SourceCatalog3FGL,\n",
       " gammapy.catalog.fermi.SourceCatalog4FGL,\n",
       " gammapy.catalog.fermi.SourceCatalog2FHL,\n",
       " gammapy.catalog.fermi.SourceCatalog3FHL]"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "CATALOG_REGISTRY"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:52.730884Z",
     "iopub.status.busy": "2020-11-19T14:16:52.730368Z",
     "iopub.status.idle": "2020-11-19T14:16:52.732648Z",
     "shell.execute_reply": "2020-11-19T14:16:52.733170Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[gammapy.catalog.gammacat.SourceCatalogGammaCat,\n",
       " gammapy.catalog.hess.SourceCatalogHGPS,\n",
       " gammapy.catalog.hawc.SourceCatalog2HWC,\n",
       " gammapy.catalog.fermi.SourceCatalog3FGL,\n",
       " gammapy.catalog.fermi.SourceCatalog4FGL,\n",
       " gammapy.catalog.fermi.SourceCatalog2FHL,\n",
       " gammapy.catalog.fermi.SourceCatalog3FHL]"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "list(CATALOG_REGISTRY)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Load catalogs\n",
    "\n",
    "If you have run `gammapy download datasets` or `gammapy download tutorials`,\n",
    "you have a copy of the catalogs as FITS files in `$GAMMAPY_DATA/catalogs`,\n",
    "and that is the default location where `~gammapy.catalog` loads from.\n",
    "\n",
    "You can load a catalog by name via `CATALOG_REGISTRY.get_cls(name)()` (note the `()` to instantiate a catalog object from the catalog class - only this will load the catalog and be useful), or by importing the catalog class (e.g. `SourceCatalog3FGL`) directly. The two ways are equivalent, the result will be the same.\n",
    "\n",
    "Note that `$GAMMAPY_DATA/catalogs` is just the default, you could pass a different `filename` when creating the catalog."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:52.736714Z",
     "iopub.status.busy": "2020-11-19T14:16:52.736236Z",
     "iopub.status.idle": "2020-11-19T14:16:52.886312Z",
     "shell.execute_reply": "2020-11-19T14:16:52.885521Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2HWC.ecsv\r\n",
      "2HWC.yaml\r\n",
      "README.rst\r\n",
      "fermi\r\n",
      "gammacat\r\n",
      "hgps_catalog_v1.fits.gz\r\n",
      "make_2hwc.py\r\n"
     ]
    }
   ],
   "source": [
    "!ls -1 $GAMMAPY_DATA/catalogs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:52.891921Z",
     "iopub.status.busy": "2020-11-19T14:16:52.891431Z",
     "iopub.status.idle": "2020-11-19T14:16:53.138989Z",
     "shell.execute_reply": "2020-11-19T14:16:53.139881Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<gammapy.catalog.fermi.SourceCatalog3FGL at 0x7f1c54fe9a90>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Catalog object - FITS file is loaded\n",
    "catalog = CATALOG_REGISTRY.get_cls(\"3fgl\")()\n",
    "catalog"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:53.144596Z",
     "iopub.status.busy": "2020-11-19T14:16:53.144045Z",
     "iopub.status.idle": "2020-11-19T14:16:53.386226Z",
     "shell.execute_reply": "2020-11-19T14:16:53.386990Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<gammapy.catalog.fermi.SourceCatalog3FGL at 0x7f1c815f6ef0>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from gammapy.catalog import SourceCatalog3FGL\n",
    "\n",
    "catalog = SourceCatalog3FGL()\n",
    "catalog"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:53.390974Z",
     "iopub.status.busy": "2020-11-19T14:16:53.390466Z",
     "iopub.status.idle": "2020-11-19T14:16:54.210770Z",
     "shell.execute_reply": "2020-11-19T14:16:54.210022Z"
    }
   },
   "outputs": [],
   "source": [
    "# Let's load the source catalogs we will use throughout this tutorial\n",
    "catalog_gammacat = CATALOG_REGISTRY.get_cls(\"gamma-cat\")()\n",
    "catalog_3fhl = CATALOG_REGISTRY.get_cls(\"3fhl\")()\n",
    "catalog_4fgl = CATALOG_REGISTRY.get_cls(\"4fgl\")()\n",
    "catalog_hgps = CATALOG_REGISTRY.get_cls(\"hgps\")()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Select a source\n",
    "\n",
    "To create a source object, index into the catalog using `[]`, passing a catalog table row index (zero-based, first row is `[0]`), or a source name. If passing a name, catalog table columns with source names and association names (\"ASSOC1\" in the example below) are searched top to bottom. There is no name resolution web query."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:54.218981Z",
     "iopub.status.busy": "2020-11-19T14:16:54.217758Z",
     "iopub.status.idle": "2020-11-19T14:16:54.220228Z",
     "shell.execute_reply": "2020-11-19T14:16:54.220727Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<gammapy.catalog.fermi.SourceCatalogObject4FGL at 0x7f1c55013198>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "source = catalog_4fgl[42]\n",
    "source"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:54.225189Z",
     "iopub.status.busy": "2020-11-19T14:16:54.224684Z",
     "iopub.status.idle": "2020-11-19T14:16:54.226914Z",
     "shell.execute_reply": "2020-11-19T14:16:54.227397Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(42, '4FGL J0010.8-2154')"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "source.row_index, source.name"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:54.260763Z",
     "iopub.status.busy": "2020-11-19T14:16:54.249917Z",
     "iopub.status.idle": "2020-11-19T14:16:56.252363Z",
     "shell.execute_reply": "2020-11-19T14:16:56.251567Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<gammapy.catalog.fermi.SourceCatalogObject4FGL at 0x7f1c851ccd30>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "source = catalog_4fgl[\"4FGL J0010.8-2154\"]\n",
    "source"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:56.256959Z",
     "iopub.status.busy": "2020-11-19T14:16:56.256441Z",
     "iopub.status.idle": "2020-11-19T14:16:56.258746Z",
     "shell.execute_reply": "2020-11-19T14:16:56.259232Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(42, '4FGL J0010.8-2154')"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "source.row_index, source.name"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:56.263167Z",
     "iopub.status.busy": "2020-11-19T14:16:56.262663Z",
     "iopub.status.idle": "2020-11-19T14:16:56.264871Z",
     "shell.execute_reply": "2020-11-19T14:16:56.265350Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'PKS 0008-222                '"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "source.data[\"ASSOC1\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:56.292953Z",
     "iopub.status.busy": "2020-11-19T14:16:56.282575Z",
     "iopub.status.idle": "2020-11-19T14:16:57.289674Z",
     "shell.execute_reply": "2020-11-19T14:16:57.290085Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(42, '4FGL J0010.8-2154')"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "source = catalog_4fgl[\"PKS 0008-222\"]\n",
    "source.row_index, source.name"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Pretty-print source information\n",
    "\n",
    "A source object has a nice string representation that you can print.\n",
    "You can also call `source.info()` instead and pass an option what information to print."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:57.300702Z",
     "iopub.status.busy": "2020-11-19T14:16:57.300187Z",
     "iopub.status.idle": "2020-11-19T14:16:57.304572Z",
     "shell.execute_reply": "2020-11-19T14:16:57.304037Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "*** Basic info ***\n",
      "\n",
      "Catalog row index (zero-based) : 18\n",
      "Source name          : HESS J1514-591\n",
      "Analysis reference   : HGPS\n",
      "Source class         : PWN\n",
      "Identified object    : MSH 15-52\n",
      "Gamma-Cat id         : 79\n",
      "\n",
      "\n",
      "*** Info from map analysis ***\n",
      "\n",
      "RA                   :  228.499 deg = 15h14m00s\n",
      "DEC                  :  -59.161 deg = -59d09m41s\n",
      "GLON                 :  320.315 +/- 0.008 deg\n",
      "GLAT                 :   -1.188 +/- 0.007 deg\n",
      "Position Error (68%) : 0.020 deg\n",
      "Position Error (95%) : 0.033 deg\n",
      "ROI number           : 13\n",
      "Spatial model        : 3-Gaussian\n",
      "Spatial components   : HGPSC 023, HGPSC 024, HGPSC 025\n",
      "TS                   : 1763.4\n",
      "sqrt(TS)             : 42.0\n",
      "Size                 : 0.145 +/- 0.026 (UL: nan) deg\n",
      "R70                  : 0.215 deg\n",
      "RSpec                : 0.215 deg\n",
      "Total model excess   : 3502.8\n",
      "Excess in RSpec      : 2440.5\n",
      "Model Excess in RSpec : 2414.3\n",
      "Background in RSpec  : 1052.5\n",
      "Livetime             : 41.4 hours\n",
      "Energy threshold     : 0.61 TeV\n",
      "Source flux (>1 TeV) : (6.434 +/- 0.211) x 10^-12 cm^-2 s^-1 = (28.47 +/- 0.94) % Crab\n",
      "\n",
      "Fluxes in RSpec (> 1 TeV):\n",
      "Map measurement                : 4.552 x 10^-12 cm^-2 s^-1 = 20.14 % Crab\n",
      "Source model                   : 4.505 x 10^-12 cm^-2 s^-1 = 19.94 % Crab\n",
      "Other component model          : 0.000 x 10^-12 cm^-2 s^-1 =  0.00 % Crab\n",
      "Large scale component model    : 0.000 x 10^-12 cm^-2 s^-1 =  0.00 % Crab\n",
      "Total model                    : 4.505 x 10^-12 cm^-2 s^-1 = 19.94 % Crab\n",
      "Containment in RSpec                :  70.0 %\n",
      "Contamination in RSpec              :   0.0 %\n",
      "Flux correction (RSpec -> Total)    : 142.8 %\n",
      "Flux correction (Total -> RSpec)    :  70.0 %\n",
      "\n",
      "*** Info from spectral analysis ***\n",
      "\n",
      "Livetime             : 13.7 hours\n",
      "Energy range:        : 0.38 to 61.90 TeV\n",
      "Background           : 1825.9\n",
      "Excess               : 2061.1\n",
      "Spectral model       : ECPL\n",
      "TS ECPL over PL      : 10.2\n",
      "Best-fit model flux(> 1 TeV) : (5.720 +/- 0.417) x 10^-12 cm^-2 s^-1  = (25.31 +/- 1.84) % Crab\n",
      "Best-fit model energy flux(1 to 10 TeV) : (20.779 +/- 1.878) x 10^-12 erg cm^-2 s^-1\n",
      "Pivot energy         : 1.54 TeV\n",
      "Flux at pivot energy : (2.579 +/- 0.083) x 10^-12 cm^-2 s^-1 TeV^-1  = (11.41 +/- 0.24) % Crab\n",
      "PL   Flux(> 1 TeV)   : (5.437 +/- 0.186) x 10^-12 cm^-2 s^-1  = (24.06 +/- 0.82) % Crab\n",
      "PL   Flux(@ 1 TeV)   : (6.868 +/- 0.241) x 10^-12 cm^-2 s^-1 TeV^-1  = (30.39 +/- 0.69) % Crab\n",
      "PL   Index           : 2.26 +/- 0.03\n",
      "ECPL   Flux(@ 1 TeV) : (6.860 +/- 0.252) x 10^-12 cm^-2 s^-1 TeV^-1  = (30.35 +/- 0.72) % Crab\n",
      "ECPL   Flux(> 1 TeV) : (5.720 +/- 0.417) x 10^-12 cm^-2 s^-1  = (25.31 +/- 1.84) % Crab\n",
      "ECPL Index           : 2.05 +/- 0.06\n",
      "ECPL Lambda          : 0.052 +/- 0.014 TeV^-1\n",
      "ECPL E_cut           : 19.20 +/- 5.01 TeV\n",
      "\n",
      "*** Flux points info ***\n",
      "\n",
      "Number of flux points: 6\n",
      "Flux points table: \n",
      "\n",
      "e_ref  e_min  e_max        dnde         dnde_errn       dnde_errp        dnde_ul     is_ul\n",
      " TeV    TeV    TeV   1 / (cm2 s TeV) 1 / (cm2 s TeV) 1 / (cm2 s TeV) 1 / (cm2 s TeV)      \n",
      "------ ------ ------ --------------- --------------- --------------- --------------- -----\n",
      " 0.562  0.383  0.825       2.439e-11       1.419e-12       1.509e-12       2.732e-11 False\n",
      " 1.212  0.825  1.778       4.439e-12       2.489e-13       2.654e-13       4.970e-12 False\n",
      " 2.738  1.778  4.217       7.295e-13       4.788e-14       4.898e-14       8.302e-13 False\n",
      " 6.190  4.217  9.085       1.305e-13       1.220e-14       1.282e-14       1.571e-13 False\n",
      "13.991  9.085 21.544       1.994e-14       2.723e-15       2.858e-15       2.588e-14 False\n",
      "31.623 21.544 46.416       9.474e-16       3.480e-16       4.329e-16       1.919e-15 False\n",
      "\n",
      "*** Gaussian component info ***\n",
      "\n",
      "Number of components: 3\n",
      "Spatial components   : HGPSC 023, HGPSC 024, HGPSC 025\n",
      "\n",
      "Component HGPSC 023:\n",
      "GLON                 :  320.303 +/- 0.005 deg\n",
      "GLAT                 :   -1.124 +/- 0.007 deg\n",
      "Size                 : 0.057 +/- 0.005 deg\n",
      "Flux (>1 TeV)        : (2.01 +/- 0.23) x 10^-12 cm^-2 s^-1 = (8.9 +/- 1.0) % Crab\n",
      "\n",
      "Component HGPSC 024:\n",
      "GLON                 :  320.298 +/- 0.020 deg\n",
      "GLAT                 :   -1.168 +/- 0.021 deg\n",
      "Size                 : 0.206 +/- 0.020 deg\n",
      "Flux (>1 TeV)        : (2.54 +/- 0.29) x 10^-12 cm^-2 s^-1 = (11.2 +/- 1.3) % Crab\n",
      "\n",
      "Component HGPSC 025:\n",
      "GLON                 :  320.351 +/- 0.005 deg\n",
      "GLAT                 :   -1.284 +/- 0.007 deg\n",
      "Size                 : 0.055 +/- 0.005 deg\n",
      "Flux (>1 TeV)        : (1.88 +/- 0.22) x 10^-12 cm^-2 s^-1 = (8.3 +/- 1.0) % Crab\n",
      "\n",
      "\n",
      "*** Source associations info ***\n",
      "\n",
      "  Source_Name    Association_Catalog    Association_Name   Separation\n",
      "                                                              deg    \n",
      "---------------- ------------------- --------------------- ----------\n",
      "  HESS J1514-591                2FHL    2FHL J1514.0-5915e   0.098903\n",
      "  HESS J1514-591                3FGL     3FGL J1513.9-5908   0.026914\n",
      "  HESS J1514-591                3FGL    3FGL J1514.0-5915e   0.094834\n",
      "  HESS J1514-591                COMP            G320.4-1.2   0.070483\n",
      "  HESS J1514-591                 PSR              B1509-58   0.026891\n",
      "\n",
      "*** Source identification info ***\n",
      "\n",
      "Source_Name: HESS J1514-591\n",
      "Identified_Object: MSH 15-52\n",
      "Class: PWN\n",
      "Evidence: Morphology\n",
      "Reference: 2005A%26A...435L..17A\n",
      "Distance_Reference: SNRCat\n",
      "Distance: 5.199999809265137 kpc\n",
      "Distance_Min: 3.799999952316284 kpc\n",
      "Distance_Max: 6.599999904632568 kpc\n",
      "\n"
     ]
    }
   ],
   "source": [
    "source = catalog_hgps[\"MSH 15-52\"]\n",
    "print(source)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:57.309370Z",
     "iopub.status.busy": "2020-11-19T14:16:57.308348Z",
     "iopub.status.idle": "2020-11-19T14:16:57.310633Z",
     "shell.execute_reply": "2020-11-19T14:16:57.311130Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "*** Source associations info ***\n",
      "\n",
      "  Source_Name    Association_Catalog    Association_Name   Separation\n",
      "                                                              deg    \n",
      "---------------- ------------------- --------------------- ----------\n",
      "  HESS J1514-591                2FHL    2FHL J1514.0-5915e   0.098903\n",
      "  HESS J1514-591                3FGL     3FGL J1513.9-5908   0.026914\n",
      "  HESS J1514-591                3FGL    3FGL J1514.0-5915e   0.094834\n",
      "  HESS J1514-591                COMP            G320.4-1.2   0.070483\n",
      "  HESS J1514-591                 PSR              B1509-58   0.026891\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(source.info(\"associations\"))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Source models\n",
    "\n",
    "The `~gammapy.catalog.SourceCatalogObject` classes have a `sky_model()` model\n",
    "which creates a `gammapy.modeling.models.SkyModel` object, with model parameter\n",
    "values and parameter errors from the catalog filled in.\n",
    "\n",
    "In most cases, the `spectral_model()` method provides the `gammapy.modeling.models.SpectralModel`\n",
    "part of the sky model, and the `spatial_model()` method the `gammapy.modeling.models.SpatialModel`\n",
    "part individually.\n",
    "\n",
    "We use the `gammapy.catalog.SourceCatalog3FHL` for the examples in this section."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:57.324019Z",
     "iopub.status.busy": "2020-11-19T14:16:57.323505Z",
     "iopub.status.idle": "2020-11-19T14:16:58.322444Z",
     "shell.execute_reply": "2020-11-19T14:16:58.321846Z"
    }
   },
   "outputs": [],
   "source": [
    "source = catalog_4fgl[\"PKS 2155-304\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:58.334773Z",
     "iopub.status.busy": "2020-11-19T14:16:58.333645Z",
     "iopub.status.idle": "2020-11-19T14:16:58.349275Z",
     "shell.execute_reply": "2020-11-19T14:16:58.349772Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "SkyModel(spatial_model=<gammapy.modeling.models.spatial.PointSpatialModel object at 0x7f1c54fe10b8>, spectral_model=<gammapy.modeling.models.spectral.LogParabolaSpectralModel object at 0x7f1c54fe9cc0>)temporal_model=None)"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model = source.sky_model()\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:58.354493Z",
     "iopub.status.busy": "2020-11-19T14:16:58.353395Z",
     "iopub.status.idle": "2020-11-19T14:16:58.355681Z",
     "shell.execute_reply": "2020-11-19T14:16:58.356173Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SkyModel\n",
      "\n",
      "  Name                      : 4FGL J2158.8-3013\n",
      "  Datasets names            : None\n",
      "  Spectral model type       : LogParabolaSpectralModel\n",
      "  Spatial  model type       : PointSpatialModel\n",
      "  Temporal model type       : \n",
      "  Parameters:\n",
      "    amplitude               :   1.38e-05  1 / (cm2 s TeV)\n",
      "    reference    (frozen)   :   0.001  TeV         \n",
      "    alpha                   :   1.763              \n",
      "    beta                    :   0.042              \n",
      "    lon_0                   : 329.714  deg         \n",
      "    lat_0                   : -30.225  deg         \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(model)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:58.361992Z",
     "iopub.status.busy": "2020-11-19T14:16:58.360881Z",
     "iopub.status.idle": "2020-11-19T14:16:58.363175Z",
     "shell.execute_reply": "2020-11-19T14:16:58.363662Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PointSpatialModel\n",
      "\n",
      " name    value    unit    min        max    frozen   error  \n",
      "----- ----------- ---- ---------- --------- ------ ---------\n",
      "lon_0  3.2971e+02  deg        nan       nan  False 3.735e-03\n",
      "lat_0 -3.0225e+01  deg -9.000e+01 9.000e+01  False 3.227e-03\n"
     ]
    }
   ],
   "source": [
    "print(model.spatial_model)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:58.369520Z",
     "iopub.status.busy": "2020-11-19T14:16:58.368425Z",
     "iopub.status.idle": "2020-11-19T14:16:58.370695Z",
     "shell.execute_reply": "2020-11-19T14:16:58.371184Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabolaSpectralModel\n",
      "\n",
      "   name     value         unit      min max frozen   error  \n",
      "--------- ---------- -------------- --- --- ------ ---------\n",
      "amplitude 1.3769e-05 cm-2 s-1 TeV-1 nan nan  False 1.801e-07\n",
      "reference 1.1365e-03            TeV nan nan   True 0.000e+00\n",
      "    alpha 1.7632e+00                nan nan  False 1.332e-02\n",
      "     beta 4.1718e-02                nan nan  False 4.680e-03\n"
     ]
    }
   ],
   "source": [
    "print(model.spectral_model)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:58.395612Z",
     "iopub.status.busy": "2020-11-19T14:16:58.387405Z",
     "iopub.status.idle": "2020-11-19T14:16:59.042118Z",
     "shell.execute_reply": "2020-11-19T14:16:59.041647Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/modeling/models/spectral.py:405: MatplotlibDeprecationWarning: The 'nonposx' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_xscale(\"log\", nonposx=\"clip\")\n",
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/modeling/models/spectral.py:406: MatplotlibDeprecationWarning: The 'nonposy' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_yscale(\"log\", nonposy=\"clip\")\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='Energy [TeV]', ylabel='E2 * Flux [erg / (cm2 s)]'>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "energy_range = (100 * u.MeV, 100 * u.GeV)\n",
    "opts = dict(energy_power=2, flux_unit=\"erg-1 cm-2 s-1\")\n",
    "model.spectral_model.plot(energy_range, **opts)\n",
    "model.spectral_model.plot_error(energy_range, **opts)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Flux points\n",
    "\n",
    "The flux points are available via the `flux_points` property as a `gammapy.spectrum.FluxPoints` object."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:59.065320Z",
     "iopub.status.busy": "2020-11-19T14:16:59.054830Z",
     "iopub.status.idle": "2020-11-19T14:17:00.070969Z",
     "shell.execute_reply": "2020-11-19T14:17:00.069460Z"
    }
   },
   "outputs": [],
   "source": [
    "source = catalog_4fgl[\"PKS 2155-304\"]\n",
    "flux_points = source.flux_points"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:00.074790Z",
     "iopub.status.busy": "2020-11-19T14:17:00.074296Z",
     "iopub.status.idle": "2020-11-19T14:17:00.079384Z",
     "shell.execute_reply": "2020-11-19T14:17:00.078728Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "FluxPoints(sed_type='flux', n_points=7)"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flux_points"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:00.084609Z",
     "iopub.status.busy": "2020-11-19T14:17:00.084110Z",
     "iopub.status.idle": "2020-11-19T14:17:00.088324Z",
     "shell.execute_reply": "2020-11-19T14:17:00.088831Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<i>Table length=7</i>\n",
       "<table id=\"table139759647338280\" class=\"table-striped table-bordered table-condensed\">\n",
       "<thead><tr><th>e_min</th><th>e_max</th><th>flux</th><th>flux_errn</th></tr></thead>\n",
       "<thead><tr><th>MeV</th><th>MeV</th><th>1 / (cm2 s)</th><th>1 / (cm2 s)</th></tr></thead>\n",
       "<thead><tr><th>float64</th><th>float64</th><th>float32</th><th>float32</th></tr></thead>\n",
       "<tr><td>50.0</td><td>100.0</td><td>7.72853e-08</td><td>4.0041947e-08</td></tr>\n",
       "<tr><td>100.0</td><td>300.0</td><td>6.633264e-08</td><td>3.3468415e-09</td></tr>\n",
       "<tr><td>300.0</td><td>1000.0</td><td>3.2824694e-08</td><td>6.9634254e-10</td></tr>\n",
       "<tr><td>1000.0</td><td>3000.0</td><td>1.2609229e-08</td><td>2.4615918e-10</td></tr>\n",
       "<tr><td>3000.0</td><td>10000.0</td><td>5.407803e-09</td><td>1.3989285e-10</td></tr>\n",
       "<tr><td>10000.0</td><td>30000.0</td><td>1.7188525e-09</td><td>7.4735836e-11</td></tr>\n",
       "<tr><td>30000.0</td><td>300000.0</td><td>6.818578e-10</td><td>4.5728827e-11</td></tr>\n",
       "</table>"
      ],
      "text/plain": [
       "<Table length=7>\n",
       " e_min   e_max        flux       flux_errn  \n",
       "  MeV     MeV     1 / (cm2 s)   1 / (cm2 s) \n",
       "float64 float64     float32       float32   \n",
       "------- -------- ------------- -------------\n",
       "   50.0    100.0   7.72853e-08 4.0041947e-08\n",
       "  100.0    300.0  6.633264e-08 3.3468415e-09\n",
       "  300.0   1000.0 3.2824694e-08 6.9634254e-10\n",
       " 1000.0   3000.0 1.2609229e-08 2.4615918e-10\n",
       " 3000.0  10000.0  5.407803e-09 1.3989285e-10\n",
       "10000.0  30000.0 1.7188525e-09 7.4735836e-11\n",
       "30000.0 300000.0  6.818578e-10 4.5728827e-11"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flux_points.table[[\"e_min\", \"e_max\", \"flux\", \"flux_errn\"]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:00.112651Z",
     "iopub.status.busy": "2020-11-19T14:17:00.102710Z",
     "iopub.status.idle": "2020-11-19T14:17:00.662286Z",
     "shell.execute_reply": "2020-11-19T14:17:00.661732Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/estimators/flux_point.py:667: MatplotlibDeprecationWarning: The 'nonposx' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_xscale(\"log\", nonposx=\"clip\")\n",
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/estimators/flux_point.py:668: MatplotlibDeprecationWarning: The 'nonposy' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_yscale(\"log\", nonposy=\"clip\")\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='Energy (TeV)', ylabel='flux (1 / (cm2 s))'>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "flux_points.plot()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Lightcurves\n",
    "\n",
    "The Fermi catalogs contain lightcurves for each source. It is available via the `source.lightcurve` property as a `~gammapy.time.LightCurve` object."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:00.675379Z",
     "iopub.status.busy": "2020-11-19T14:17:00.674887Z",
     "iopub.status.idle": "2020-11-19T14:17:01.692113Z",
     "shell.execute_reply": "2020-11-19T14:17:01.691622Z"
    }
   },
   "outputs": [],
   "source": [
    "lightcurve = catalog_4fgl[\"4FGL J0349.8-2103\"].lightcurve"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:01.695613Z",
     "iopub.status.busy": "2020-11-19T14:17:01.695104Z",
     "iopub.status.idle": "2020-11-19T14:17:01.699054Z",
     "shell.execute_reply": "2020-11-19T14:17:01.698623Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "LightCurve(len=8)"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "lightcurve"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:01.704211Z",
     "iopub.status.busy": "2020-11-19T14:17:01.703737Z",
     "iopub.status.idle": "2020-11-19T14:17:01.705926Z",
     "shell.execute_reply": "2020-11-19T14:17:01.706388Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<i>Table length=3</i>\n",
       "<table id=\"table139759645271488\" class=\"table-striped table-bordered table-condensed\">\n",
       "<thead><tr><th>time_min</th><th>time_max</th><th>flux</th><th>flux_errp</th><th>flux_errn</th></tr></thead>\n",
       "<thead><tr><th></th><th></th><th>1 / (cm2 s)</th><th>1 / (cm2 s)</th><th>1 / (cm2 s)</th></tr></thead>\n",
       "<thead><tr><th>float64</th><th>float64</th><th>float32</th><th>float32</th><th>float32</th></tr></thead>\n",
       "<tr><td>54682.655277777776</td><td>55047.603239293836</td><td>8.4104094e-08</td><td>4.119689e-09</td><td>4.119689e-09</td></tr>\n",
       "<tr><td>55047.603239293836</td><td>55412.55121238397</td><td>3.6117186e-08</td><td>3.434389e-09</td><td>3.434389e-09</td></tr>\n",
       "<tr><td>55412.55121238397</td><td>55777.4991854741</td><td>1.4224756e-08</td><td>2.7470255e-09</td><td>2.6878597e-09</td></tr>\n",
       "</table>"
      ],
      "text/plain": [
       "<Table length=3>\n",
       "     time_min           time_max           flux       flux_errp     flux_errn  \n",
       "                                       1 / (cm2 s)   1 / (cm2 s)   1 / (cm2 s) \n",
       "     float64            float64          float32       float32       float32   \n",
       "------------------ ------------------ ------------- ------------- -------------\n",
       "54682.655277777776 55047.603239293836 8.4104094e-08  4.119689e-09  4.119689e-09\n",
       "55047.603239293836  55412.55121238397 3.6117186e-08  3.434389e-09  3.434389e-09\n",
       " 55412.55121238397   55777.4991854741 1.4224756e-08 2.7470255e-09 2.6878597e-09"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "lightcurve.table[:3]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:01.733371Z",
     "iopub.status.busy": "2020-11-19T14:17:01.732367Z",
     "iopub.status.idle": "2020-11-19T14:17:01.855381Z",
     "shell.execute_reply": "2020-11-19T14:17:01.854833Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "No handles with labels found to put in legend.\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='Time (MJD)', ylabel='Flux (cm-2 s-1)'>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "lightcurve.plot()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Catalog table and source dictionary\n",
    "\n",
    "Source catalogs are given as `FITS` files that contain one or multiple tables.\n",
    "Above we showed how to get spectra, light curves and other information as Gammapy objects.\n",
    "\n",
    "However, you can also access the underlying `astropy.table.Table` for a catalog,\n",
    "and the row data as a Python `dict`. This can be useful if you want to do something\n",
    "that is not pre-scripted by the `~gammapy.catalog` classes, such as e.g. selecting\n",
    "sources by sky position or association class, or accessing special source information\n",
    "(like e.g. `Npred` in the example below).\n",
    "\n",
    "Note that you can also do a `for source in catalog` loop, to find or process\n",
    "sources of interest."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:01.859802Z",
     "iopub.status.busy": "2020-11-19T14:17:01.859314Z",
     "iopub.status.idle": "2020-11-19T14:17:01.863559Z",
     "shell.execute_reply": "2020-11-19T14:17:01.863022Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "astropy.table.table.Table"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "type(catalog_3fhl.table)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:01.867769Z",
     "iopub.status.busy": "2020-11-19T14:17:01.867261Z",
     "iopub.status.idle": "2020-11-19T14:17:01.869565Z",
     "shell.execute_reply": "2020-11-19T14:17:01.870053Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1556"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(catalog_3fhl.table)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:01.880561Z",
     "iopub.status.busy": "2020-11-19T14:17:01.880077Z",
     "iopub.status.idle": "2020-11-19T14:17:01.882411Z",
     "shell.execute_reply": "2020-11-19T14:17:01.882914Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<i>Table length=3</i>\n",
       "<table id=\"table139759644369808\" class=\"table-striped table-bordered table-condensed\">\n",
       "<thead><tr><th>Source_Name</th><th>RAJ2000</th><th>DEJ2000</th></tr></thead>\n",
       "<thead><tr><th></th><th>deg</th><th>deg</th></tr></thead>\n",
       "<thead><tr><th>bytes18</th><th>float32</th><th>float32</th></tr></thead>\n",
       "<tr><td>3FHL J0001.2-0748</td><td>0.3107</td><td>-7.8075</td></tr>\n",
       "<tr><td>3FHL J0001.9-4155</td><td>0.4849</td><td>-41.9303</td></tr>\n",
       "<tr><td>3FHL J0002.1-6728</td><td>0.5283</td><td>-67.4825</td></tr>\n",
       "</table>"
      ],
      "text/plain": [
       "<Table length=3>\n",
       "   Source_Name     RAJ2000  DEJ2000 \n",
       "                     deg      deg   \n",
       "     bytes18       float32  float32 \n",
       "------------------ -------- --------\n",
       "3FHL J0001.2-0748    0.3107  -7.8075\n",
       "3FHL J0001.9-4155    0.4849 -41.9303\n",
       "3FHL J0002.1-6728    0.5283 -67.4825"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "catalog_3fhl.table[:3][[\"Source_Name\", \"RAJ2000\", \"DEJ2000\"]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:01.900125Z",
     "iopub.status.busy": "2020-11-19T14:17:01.894975Z",
     "iopub.status.idle": "2020-11-19T14:17:02.209786Z",
     "shell.execute_reply": "2020-11-19T14:17:02.208898Z"
    }
   },
   "outputs": [],
   "source": [
    "source = catalog_3fhl[\"PKS 2155-304\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:02.213876Z",
     "iopub.status.busy": "2020-11-19T14:17:02.213366Z",
     "iopub.status.idle": "2020-11-19T14:17:02.217485Z",
     "shell.execute_reply": "2020-11-19T14:17:02.216920Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'3FHL J2158.8-3013 '"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "source.data[\"Source_Name\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:02.221713Z",
     "iopub.status.busy": "2020-11-19T14:17:02.221218Z",
     "iopub.status.idle": "2020-11-19T14:17:02.223499Z",
     "shell.execute_reply": "2020-11-19T14:17:02.223994Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "678.95544"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "source.data[\"Npred\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:02.239058Z",
     "iopub.status.busy": "2020-11-19T14:17:02.238548Z",
     "iopub.status.idle": "2020-11-19T14:17:02.240844Z",
     "shell.execute_reply": "2020-11-19T14:17:02.241368Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<SkyCoord (ICRS): (ra, dec) in deg\n",
       "    (329.71694946, -30.22418594)>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "source.position"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:02.324223Z",
     "iopub.status.busy": "2020-11-19T14:17:02.323671Z",
     "iopub.status.idle": "2020-11-19T14:17:06.126917Z",
     "shell.execute_reply": "2020-11-19T14:17:06.126185Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "352     3FHL J0534.5+2201    2.99e-10 1 / (cm2 s)\n",
      "553     3FHL J0851.9-4620e   1.24e-10 1 / (cm2 s)\n",
      "654     3FHL J1036.3-5833e   1.57e-10 1 / (cm2 s)\n",
      "691     3FHL J1104.4+3812    3.34e-10 1 / (cm2 s)\n",
      "1111    3FHL J1653.8+3945    1.27e-10 1 / (cm2 s)\n",
      "1219    3FHL J1824.5-1351e   1.77e-10 1 / (cm2 s)\n",
      "1361    3FHL J2028.6+4110e   1.75e-10 1 / (cm2 s)\n"
     ]
    }
   ],
   "source": [
    "# Find the brightest sources in the 100 to 200 GeV energy band\n",
    "for source in catalog_3fhl:\n",
    "    flux = (\n",
    "        source.spectral_model()\n",
    "        .integral(100 * u.GeV, 200 * u.GeV)\n",
    "        .to(\"cm-2 s-1\")\n",
    "    )\n",
    "    if flux > 1e-10 * u.Unit(\"cm-2 s-1\"):\n",
    "        print(f\"{source.row_index:<7d} {source.name:20s} {flux:.3g}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Exercises\n",
    "\n",
    "- How many sources are in the 4FGL catalog? (try `len(catalog.table)`\n",
    "- What is the name of the source with row index 42?\n",
    "- What is the row index of the source with name \"4FGL J0536.1-1205\"?\n",
    "- What is the integral flux of \"4FGL J0536.1-1205\" in the energy range 100 GeV to 1 TeV according to the best-fit spectral model?\n",
    "- Which source in the HGPS catalog is closest to Galactic position `glon = 42 deg` and `glat = 0 deg`?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:17:06.129932Z",
     "iopub.status.busy": "2020-11-19T14:17:06.129475Z",
     "iopub.status.idle": "2020-11-19T14:17:06.132760Z",
     "shell.execute_reply": "2020-11-19T14:17:06.132123Z"
    }
   },
   "outputs": [],
   "source": [
    "# Start coding here ..."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Next steps\n",
    "\n",
    "`~gammapy.catalog` is mostly independent from the rest of Gammapy.\n",
    "Typically you use it to compare new analyses against catalog results, e.g. overplot the spectral model, or compare the source position.\n",
    "\n",
    "You can also use `~gammapy.catalog` in your scripts to create initial source models for your analyses.\n",
    "This is very common for Fermi-LAT, to start with a catalog model.\n",
    "For TeV analysis, especially in crowded Galactic regions, using the HGPS, gamma-cat or 2HWC catalog in this way can also be useful.\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
