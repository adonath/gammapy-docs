{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://static.mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/master?urlpath=lab/tree/analysis_mwl.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/docs/tutorials).\n",
    "- **Source files:**\n",
    "[analysis_mwl.ipynb](../_static/notebooks/analysis_mwl.ipynb) |\n",
    "[analysis_mwl.py](../_static/notebooks/analysis_mwl.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Joint modeling, fitting, and serialization\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Prerequisites\n",
    "\n",
    "- Handling of Fermi-LAT data with gammapy [see the corresponding tutorial](fermi_lat.ipynb)\n",
    "- Knowledge of spectral analysis to produce 1D On-Off datasets, [see the following tutorial](spectrum_analysis.ipynb)\n",
    "- Using flux points to directly fit a model (without forward-folding)  [see the SED fitting tutorial](sed_fitting.ipynb)\n",
    "\n",
    "## Context\n",
    "\n",
    "Some science studies require to combine heterogeneous data from various instruments to extract physical informations. In particular, it is often useful to add flux measurements of a source at different energies to an analysis to better constrain the wide-band spectral parameters. This can be done using a joint fit of heterogeneous datasets.\n",
    " \n",
    "**Objectives: Constrain the spectral parameters of the gamma-ray emission from the Crab nebula between 10 GeV and 100 TeV, using a 3D Fermi dataset, a H.E.S.S. reduced spectrum and HAWC flux points.**\n",
    "\n",
    "## Proposed approach\n",
    "\n",
    "This tutorial illustrates how to perfom a joint modeling and fitting of the Crab Nebula spectrum using different datasets.\n",
    "The spectral parameters are optimized by combining a 3D analysis of Fermi-LAT data, a ON/OFF spectral analysis of HESS data, and flux points from HAWC.\n",
    "\n",
    "In this tutorial we are going to use pre-made datasets. We prepared maps of the Crab region as seen by Fermi-LAT using the same event selection than the [3FHL catalog](https://arxiv.org/abs/1702.00664) (7 years of data with energy from 10 GeV to 2 TeV). For the HESS ON/OFF analysis we used two observations from the [first public data release](https://arxiv.org/abs/1810.04516) with a significant signal from energy of about 600 GeV to 10 TeV. These observations have an offset of 0.5° and a zenith angle of 45-48°. The HAWC flux points data are taken from a [recent analysis](https://arxiv.org/pdf/1905.12518.pdf) based on 2.5 years of data with energy between 300 Gev and 300 TeV. \n",
    "\n",
    "## The setup\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-30T09:08:14.721510Z",
     "iopub.status.busy": "2020-10-30T09:08:14.720863Z",
     "iopub.status.idle": "2020-10-30T09:08:16.178022Z",
     "shell.execute_reply": "2020-10-30T09:08:16.176553Z"
    }
   },
   "outputs": [],
   "source": [
    "from astropy import units as u\n",
    "import matplotlib.pyplot as plt\n",
    "from gammapy.modeling import Fit\n",
    "from gammapy.datasets import Datasets, FluxPointsDataset, SpectrumDatasetOnOff\n",
    "from gammapy.estimators import FluxPoints, FluxPointsEstimator\n",
    "from gammapy.maps import MapAxis\n",
    "from pathlib import Path"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Data and models files\n",
    "\n",
    "\n",
    "The datasets serialization produce YAML files listing the datasets and models. In the following cells we show an example containning only the Fermi-LAT dataset and the Crab model. \n",
    "\n",
    "Fermi-LAT-3FHL_datasets.yaml:\n",
    "\n",
    "```yaml\n",
    "datasets:\n",
    "- name: Fermi-LAT\n",
    "  type: MapDataset\n",
    "  likelihood: cash\n",
    "  models:\n",
    "- Crab Nebula\n",
    "  background: background\n",
    "  filename: $GAMMAPY_DATA/fermi-3fhl-crab/Fermi-LAT-3FHL_data_Fermi-LAT.fits\n",
    "```\n",
    "\n",
    "We used as model a point source with a log-parabola spectrum. The initial parameters were taken from the latest Fermi-LAT catalog [4FGL](https://arxiv.org/abs/1902.10045), then we have re-optimized the spectral parameters for our dataset in the 10 GeV - 2 TeV energy range (fixing the source position).\n",
    "\n",
    "Fermi-LAT-3FHL_models.yaml:\n",
    "\n",
    "```yaml\n",
    "components:\n",
    "- name: Crab Nebula\n",
    "  type: SkyModel\n",
    "  spatial:\n",
    "    type: PointSpatialModel\n",
    "    frame: icrs\n",
    "    parameters:\n",
    "    - name: lon_0\n",
    "      value: 83.63310241699219\n",
    "      unit: deg\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: true\n",
    "    - name: lat_0\n",
    "      value: 22.019899368286133\n",
    "      unit: deg\n",
    "      min: -90.0\n",
    "      max: 90.0\n",
    "      frozen: true\n",
    "  spectral:\n",
    "    type: LogParabolaSpectralModel\n",
    "    parameters:\n",
    "    - name: amplitude\n",
    "      value: 0.3415498620816483\n",
    "      unit: cm-2 s-1 TeV-1\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: false\n",
    "    - name: reference\n",
    "      value: 5.054833602905273e-05\n",
    "      unit: TeV\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: true\n",
    "    - name: alpha\n",
    "      value: 2.510798031388936\n",
    "      unit: ''\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: false\n",
    "    - name: beta\n",
    "      value: -0.022476498188855533\n",
    "      unit: ''\n",
    "      min: .nan\n",
    "      max: .nan\n",
    "      frozen: false\n",
    "- name: background\n",
    "  type: BackgroundModel\n",
    "  parameters:\n",
    "  - name: norm\n",
    "    value: 0.9544383244743555\n",
    "    unit: ''\n",
    "    min: 0.0\n",
    "    max: .nan\n",
    "    frozen: false\n",
    "  - name: tilt\n",
    "    value: 0.0\n",
    "    unit: ''\n",
    "    min: .nan\n",
    "    max: .nan\n",
    "    frozen: true\n",
    "  - name: reference\n",
    "    value: 1.0\n",
    "    unit: TeV\n",
    "    min: .nan\n",
    "    max: .nan\n",
    "    frozen: true\n",
    "\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Reading  different datasets\n",
    "\n",
    "\n",
    "### Fermi-LAT 3FHL: map dataset for 3D analysis\n",
    "For now we let's use the datasets serialization only to read the 3D `MapDataset` associated to Fermi-LAT 3FHL data and models."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-30T09:08:16.183949Z",
     "iopub.status.busy": "2020-10-30T09:08:16.183304Z",
     "iopub.status.idle": "2020-10-30T09:08:16.309366Z",
     "shell.execute_reply": "2020-10-30T09:08:16.308772Z"
    }
   },
   "outputs": [],
   "source": [
    "path = Path(\"$GAMMAPY_DATA/fermi-3fhl-crab\")\n",
    "filedata = \"Fermi-LAT-3FHL_datasets.yaml\"\n",
    "filemodel = \"Fermi-LAT-3FHL_models.yaml\"\n",
    "datasets = Datasets.read(path, filedata=filedata, filemodel=filemodel)\n",
    "dataset_fermi = datasets[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-30T09:08:16.315737Z",
     "iopub.status.busy": "2020-10-30T09:08:16.314256Z",
     "iopub.status.idle": "2020-10-30T09:08:16.317622Z",
     "shell.execute_reply": "2020-10-30T09:08:16.318257Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ProperModels\n",
      "\n",
      "Component 0: SkyModel\n",
      "\n",
      "  Name                      : Crab Nebula\n",
      "  Datasets names            : None\n",
      "  Spectral model type       : LogParabolaSpectralModel\n",
      "  Spatial  model type       : PointSpatialModel\n",
      "  Temporal model type       : \n",
      "  Parameters:\n",
      "    amplitude               :   1.82e-02  1 / (cm2 s TeV)\n",
      "    reference    (frozen)   :   0.000  TeV         \n",
      "    alpha                   :   1.652              \n",
      "    beta                    :   0.039              \n",
      "    lon_0        (frozen)   :  83.633  deg         \n",
      "    lat_0        (frozen)   :  22.020  deg         \n",
      "\n",
      "Component 1: FoVBackgroundModel\n",
      "\n",
      "  Name                      : Fermi-LAT-bkg\n",
      "  Datasets names            : ['Fermi-LAT']\n",
      "  Spectral model type       : PowerLawNormSpectralModel\n",
      "  Parameters:\n",
      "    norm                    :   1.300              \n",
      "    tilt         (frozen)   :   0.000              \n",
      "    reference    (frozen)   :   1.000  TeV         \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(datasets[0].models)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We get the Crab model in order to share it with the other datasets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-30T09:08:16.327460Z",
     "iopub.status.busy": "2020-10-30T09:08:16.325822Z",
     "iopub.status.idle": "2020-10-30T09:08:16.328880Z",
     "shell.execute_reply": "2020-10-30T09:08:16.329470Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabolaSpectralModel\n",
      "\n",
      "   name     value         unit      min max frozen   error  \n",
      "--------- ---------- -------------- --- --- ------ ---------\n",
      "amplitude 1.8183e-02 cm-2 s-1 TeV-1 nan nan  False 3.026e-03\n",
      "reference 5.0548e-05            TeV nan nan   True 0.000e+00\n",
      "    alpha 1.6524e+00                nan nan  False 5.763e-02\n",
      "     beta 3.9217e-02                nan nan  False 5.215e-03\n"
     ]
    }
   ],
   "source": [
    "crab_model = dataset_fermi.models[\"Crab Nebula\"]\n",
    "crab_spec = crab_model.spectral_model\n",
    "print(crab_spec)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### HESS-DL3: 1D ON/OFF dataset for spectral fitting\n",
    "\n",
    "The ON/OFF datasets can be read from PHA files following the [OGIP standards](https://heasarc.gsfc.nasa.gov/docs/heasarc/ofwg/docs/spectra/ogip_92_007/node5.html).\n",
    "We read the PHA files from each observation, and compute a stacked dataset for simplicity.\n",
    "Then the Crab spectral model previously defined is added to the dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-30T09:08:16.335222Z",
     "iopub.status.busy": "2020-10-30T09:08:16.334302Z",
     "iopub.status.idle": "2020-10-30T09:08:16.588983Z",
     "shell.execute_reply": "2020-10-30T09:08:16.589492Z"
    }
   },
   "outputs": [],
   "source": [
    "datasets = []\n",
    "\n",
    "for obs_id in [23523, 23526]:\n",
    "    dataset = SpectrumDatasetOnOff.from_ogip_files(\n",
    "        f\"$GAMMAPY_DATA/joint-crab/spectra/hess/pha_obs{obs_id}.fits\"\n",
    "    )\n",
    "    datasets.append(dataset)\n",
    "\n",
    "dataset_hess = Datasets(datasets).stack_reduce(name=\"HESS\")\n",
    "dataset_hess.models = crab_model"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### HAWC: 1D dataset for flux point fitting\n",
    "\n",
    "The HAWC flux point are taken from https://arxiv.org/pdf/1905.12518.pdf. Then these flux points are read from a pre-made FITS file and passed to a `FluxPointsDataset` together with the source spectral model.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-30T09:08:16.594284Z",
     "iopub.status.busy": "2020-10-30T09:08:16.593512Z",
     "iopub.status.idle": "2020-10-30T09:08:16.605255Z",
     "shell.execute_reply": "2020-10-30T09:08:16.604662Z"
    }
   },
   "outputs": [],
   "source": [
    "# read flux points from https://arxiv.org/pdf/1905.12518.pdf\n",
    "filename = \"$GAMMAPY_DATA/hawc_crab/HAWC19_flux_points.fits\"\n",
    "flux_points_hawc = FluxPoints.read(filename)\n",
    "dataset_hawc = FluxPointsDataset(crab_model, flux_points_hawc, name=\"HAWC\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Datasets serialization\n",
    "\n",
    "The `datasets` object contains each dataset previously defined. \n",
    "It can be saved on disk as datasets.yaml, models.yaml, and several data files specific to each dataset. Then the `datasets` can be rebuild later from these files."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-30T09:08:16.611097Z",
     "iopub.status.busy": "2020-10-30T09:08:16.609620Z",
     "iopub.status.idle": "2020-10-30T09:08:17.380313Z",
     "shell.execute_reply": "2020-10-30T09:08:17.381992Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "HDU 'MASK_FIT' not found\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/numpy/core/_asarray.py:83: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray\n",
      "  return array(a, dtype, copy=False, order=order)\n"
     ]
    }
   ],
   "source": [
    "datasets = Datasets([dataset_fermi, dataset_hess, dataset_hawc])\n",
    "path = Path(\"crab-3datasets\")\n",
    "path.mkdir(exist_ok=True)\n",
    "\n",
    "datasets.write(path=path, prefix=\"crab_10GeV_100TeV\", overwrite=True)\n",
    "filedata = \"crab_10GeV_100TeV_datasets.yaml\"\n",
    "filemodel = \"crab_10GeV_100TeV_models.yaml\"\n",
    "datasets = Datasets.read(path, filedata=filedata, filemodel=filemodel)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-30T09:08:17.387868Z",
     "iopub.status.busy": "2020-10-30T09:08:17.387232Z",
     "iopub.status.idle": "2020-10-30T09:08:17.394076Z",
     "shell.execute_reply": "2020-10-30T09:08:17.394545Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datasets\n",
      "--------\n",
      "\n",
      "Dataset 0: \n",
      "\n",
      "  Type       : MapDataset\n",
      "  Name       : Fermi-LAT\n",
      "  Instrument : \n",
      "  Models     : ['Crab Nebula', 'Fermi-LAT-bkg']\n",
      "\n",
      "Dataset 1: \n",
      "\n",
      "  Type       : SpectrumDatasetOnOff\n",
      "  Name       : HESS\n",
      "  Instrument : \n",
      "  Models     : ['Crab Nebula']\n",
      "\n",
      "Dataset 2: \n",
      "\n",
      "  Type       : FluxPointsDataset\n",
      "  Name       : HAWC\n",
      "  Instrument : \n",
      "  Models     : ['Crab Nebula']\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(datasets)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-30T09:08:17.400141Z",
     "iopub.status.busy": "2020-10-30T09:08:17.399534Z",
     "iopub.status.idle": "2020-10-30T09:08:17.402357Z",
     "shell.execute_reply": "2020-10-30T09:08:17.402958Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ProperModels\n",
      "\n",
      "Component 0: SkyModel\n",
      "\n",
      "  Name                      : Crab Nebula\n",
      "  Datasets names            : None\n",
      "  Spectral model type       : LogParabolaSpectralModel\n",
      "  Spatial  model type       : PointSpatialModel\n",
      "  Temporal model type       : \n",
      "  Parameters:\n",
      "    amplitude               :   1.82e-02  1 / (cm2 s TeV)\n",
      "    reference               :   0.000  TeV         \n",
      "    alpha                   :   1.652              \n",
      "    beta                    :   0.039              \n",
      "    lon_0        (frozen)   :  83.633  deg         \n",
      "    lat_0        (frozen)   :  22.020  deg         \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(datasets[\"HESS\"].models)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Joint analysis\n",
    "\n",
    "We run the fit on the `Datasets` object that include a dataset for each instrument\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-30T09:08:17.413077Z",
     "iopub.status.busy": "2020-10-30T09:08:17.412391Z",
     "iopub.status.idle": "2020-10-30T09:08:35.654853Z",
     "shell.execute_reply": "2020-10-30T09:08:35.655347Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "HDU 'MASK_FIT' not found\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in log\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in log\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/astropy/units/quantity.py:477: RuntimeWarning: invalid value encountered in power\n",
      "  result = super().__array_ufunc__(function, method, *arrays, **kwargs)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OptimizeResult\n",
      "\n",
      "\tbackend    : minuit\n",
      "\tmethod     : minuit\n",
      "\tsuccess    : True\n",
      "\tmessage    : Optimization terminated successfully.\n",
      "\tnfev       : 1163\n",
      "\ttotal stat : -12695.41\n",
      "\n",
      "   name      value         unit      min max frozen   error  \n",
      "--------- ----------- -------------- --- --- ------ ---------\n",
      "amplitude  3.3880e-03 cm-2 s-1 TeV-1 nan nan  False 2.796e-04\n",
      "reference  5.6515e-05            TeV nan nan  False 2.635e-06\n",
      "    alpha  1.2700e+00                nan nan  False 9.348e-03\n",
      "     beta  6.1976e-02                nan nan  False 5.553e-04\n",
      "    lon_0  8.3633e+01            deg nan nan   True 0.000e+00\n",
      "    lat_0  2.2020e+01            deg nan nan   True 0.000e+00\n",
      "     norm  1.6119e+00                nan nan  False 5.684e-01\n",
      "     tilt -5.8345e-02                nan nan  False 8.756e-02\n",
      "reference  8.4297e-01            TeV nan nan  False 3.078e+00\n",
      "CPU times: user 18.3 s, sys: 63.6 ms, total: 18.3 s\n",
      "Wall time: 18.2 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "fit_joint = Fit(datasets)\n",
    "results_joint = fit_joint.run()\n",
    "print(results_joint)\n",
    "print(results_joint.parameters.to_table())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's display only the parameters of the Crab spectral model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-30T09:08:35.662029Z",
     "iopub.status.busy": "2020-10-30T09:08:35.661433Z",
     "iopub.status.idle": "2020-10-30T09:08:35.665710Z",
     "shell.execute_reply": "2020-10-30T09:08:35.666278Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabolaSpectralModel\n",
      "\n",
      "   name     value         unit      min max frozen   error  \n",
      "--------- ---------- -------------- --- --- ------ ---------\n",
      "amplitude 3.3880e-03 cm-2 s-1 TeV-1 nan nan  False 2.796e-04\n",
      "reference 5.6515e-05            TeV nan nan  False 2.635e-06\n",
      "    alpha 1.2700e+00                nan nan  False 9.348e-03\n",
      "     beta 6.1976e-02                nan nan  False 5.553e-04\n"
     ]
    }
   ],
   "source": [
    "crab_spec = datasets[0].models[\"Crab Nebula\"].spectral_model\n",
    "print(crab_spec)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can compute flux points for Fermi-LAT and HESS datasets in order plot them together with the HAWC flux point."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-30T09:08:35.673992Z",
     "iopub.status.busy": "2020-10-30T09:08:35.672911Z",
     "iopub.status.idle": "2020-10-30T09:08:35.676252Z",
     "shell.execute_reply": "2020-10-30T09:08:35.676882Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "MapAxis\n",
       "\n",
       "\tname       : energy    \n",
       "\tunit       : 'TeV'     \n",
       "\tnbins      : 5         \n",
       "\tnode type  : edges     \n",
       "\tedges min  : 1.0e-02 TeV\n",
       "\tedges max  : 2.0e+00 TeV\n",
       "\tinterp     : log       "
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dataset_fermi.counts.geom.axes[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-30T09:08:35.688435Z",
     "iopub.status.busy": "2020-10-30T09:08:35.687445Z",
     "iopub.status.idle": "2020-10-30T09:08:44.811749Z",
     "shell.execute_reply": "2020-10-30T09:08:44.811176Z"
    }
   },
   "outputs": [],
   "source": [
    "# compute Fermi-LAT and HESS flux points\n",
    "e_edges = MapAxis.from_energy_bounds(\"10 GeV\", \"2 TeV\", nbin=5).edges\n",
    "\n",
    "flux_points_fermi = FluxPointsEstimator(\n",
    "    e_edges=e_edges, source=\"Crab Nebula\"\n",
    ").run([dataset_fermi])\n",
    "\n",
    "\n",
    "e_edges = MapAxis.from_bounds(1, 15, nbin=6, interp=\"log\", unit=\"TeV\").edges\n",
    "flux_points_hess = FluxPointsEstimator(\n",
    "    e_edges=e_edges, source=\"Crab Nebula\"\n",
    ").run([dataset_hess])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now, Let's plot the Crab spectrum fitted and the flux points of each instrument.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-10-30T09:08:44.818659Z",
     "iopub.status.busy": "2020-10-30T09:08:44.817951Z",
     "iopub.status.idle": "2020-10-30T09:08:45.955656Z",
     "shell.execute_reply": "2020-10-30T09:08:45.956201Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/modeling/models/spectral.py:411: MatplotlibDeprecationWarning: The 'nonposx' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_xscale(\"log\", nonposx=\"clip\")\n",
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/modeling/models/spectral.py:412: MatplotlibDeprecationWarning: The 'nonposy' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_yscale(\"log\", nonposy=\"clip\")\n",
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/estimators/flux_point.py:668: MatplotlibDeprecationWarning: The 'nonposx' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_xscale(\"log\", nonposx=\"clip\")\n",
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/estimators/flux_point.py:669: MatplotlibDeprecationWarning: The 'nonposy' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_yscale(\"log\", nonposy=\"clip\")\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<matplotlib.legend.Legend at 0x7f1a8d6e5780>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# display spectrum and flux points\n",
    "energy_range = [0.01, 120] * u.TeV\n",
    "plt.figure(figsize=(8, 6))\n",
    "ax = crab_spec.plot(energy_range=energy_range, energy_power=2, label=\"Model\")\n",
    "crab_spec.plot_error(ax=ax, energy_range=energy_range, energy_power=2)\n",
    "flux_points_fermi.plot(ax=ax, energy_power=2, label=\"Fermi-LAT\")\n",
    "flux_points_hess.plot(ax=ax, energy_power=2, label=\"HESS\")\n",
    "flux_points_hawc.plot(ax=ax, energy_power=2, label=\"HAWC\")\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
