{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://static.mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/master?urlpath=lab/tree/analysis_mwl.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/docs/tutorials).\n",
    "- **Source files:**\n",
    "[analysis_mwl.ipynb](../_static/notebooks/analysis_mwl.ipynb) |\n",
    "[analysis_mwl.py](../_static/notebooks/analysis_mwl.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Joint modeling, fitting, and serialization\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Prerequisites\n",
    "\n",
    "- Handling of Fermi-LAT data with gammapy [see the corresponding tutorial](fermi_lat.ipynb)\n",
    "- Knowledge of spectral analysis to produce 1D On-Off datasets, [see the following tutorial](spectrum_analysis.ipynb)\n",
    "- Using flux points to directly fit a model (without forward-folding)  [see the SED fitting tutorial](sed_fitting.ipynb)\n",
    "\n",
    "## Context\n",
    "\n",
    "Some science studies require to combine heterogeneous data from various instruments to extract physical informations. In particular, it is often useful to add flux measurements of a source at different energies to an analysis to better constrain the wide-band spectral parameters. This can be done using a joint fit of heterogeneous datasets.\n",
    " \n",
    "**Objectives: Constrain the spectral parameters of the gamma-ray emission from the Crab nebula between 10 GeV and 100 TeV, using a 3D Fermi dataset, a H.E.S.S. reduced spectrum and HAWC flux points.**\n",
    "\n",
    "## Proposed approach\n",
    "\n",
    "This tutorial illustrates how to perfom a joint modeling and fitting of the Crab Nebula spectrum using different datasets.\n",
    "The spectral parameters are optimized by combining a 3D analysis of Fermi-LAT data, a ON/OFF spectral analysis of HESS data, and flux points from HAWC.\n",
    "\n",
    "In this tutorial we are going to use pre-made datasets. We prepared maps of the Crab region as seen by Fermi-LAT using the same event selection than the [3FHL catalog](https://arxiv.org/abs/1702.00664) (7 years of data with energy from 10 GeV to 2 TeV). For the HESS ON/OFF analysis we used two observations from the [first public data release](https://arxiv.org/abs/1810.04516) with a significant signal from energy of about 600 GeV to 10 TeV. These observations have an offset of 0.5° and a zenith angle of 45-48°. The HAWC flux points data are taken from a [recent analysis](https://arxiv.org/pdf/1905.12518.pdf) based on 2.5 years of data with energy between 300 Gev and 300 TeV. \n",
    "\n",
    "## The setup\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:14.902719Z",
     "iopub.status.busy": "2020-11-19T14:16:14.902152Z",
     "iopub.status.idle": "2020-11-19T14:16:16.095403Z",
     "shell.execute_reply": "2020-11-19T14:16:16.095839Z"
    }
   },
   "outputs": [],
   "source": [
    "from astropy import units as u\n",
    "import matplotlib.pyplot as plt\n",
    "from gammapy.modeling import Fit\n",
    "from gammapy.modeling.models import Models\n",
    "from gammapy.datasets import Datasets, FluxPointsDataset, SpectrumDatasetOnOff\n",
    "from gammapy.estimators import FluxPoints, FluxPointsEstimator\n",
    "from gammapy.maps import MapAxis\n",
    "from pathlib import Path"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Data and models files\n",
    "\n",
    "\n",
    "The datasets serialization produce YAML files listing the datasets and models. In the following cells we show an example containning only the Fermi-LAT dataset and the Crab model. \n",
    "\n",
    "Fermi-LAT-3FHL_datasets.yaml:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:16.101293Z",
     "iopub.status.busy": "2020-11-19T14:16:16.100354Z",
     "iopub.status.idle": "2020-11-19T14:16:16.250922Z",
     "shell.execute_reply": "2020-11-19T14:16:16.251349Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "datasets:\r\n",
      "- name: Fermi-LAT\r\n",
      "  type: MapDataset\r\n",
      "  filename: Fermi-LAT-3FHL_data_Fermi-LAT.fits\r\n"
     ]
    }
   ],
   "source": [
    "!cat $GAMMAPY_DATA/fermi-3fhl-crab/Fermi-LAT-3FHL_datasets.yaml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We used as model a point source with a log-parabola spectrum. The initial parameters were taken from the latest Fermi-LAT catalog [4FGL](https://arxiv.org/abs/1902.10045), then we have re-optimized the spectral parameters for our dataset in the 10 GeV - 2 TeV energy range (fixing the source position).\n",
    "\n",
    "Fermi-LAT-3FHL_models.yaml:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:16.259895Z",
     "iopub.status.busy": "2020-11-19T14:16:16.257634Z",
     "iopub.status.idle": "2020-11-19T14:16:16.409141Z",
     "shell.execute_reply": "2020-11-19T14:16:16.408139Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "components:\r\n",
      "-   name: Crab Nebula\r\n",
      "    type: SkyModel\r\n",
      "    spectral:\r\n",
      "        type: LogParabolaSpectralModel\r\n",
      "        parameters:\r\n",
      "        -   name: amplitude\r\n",
      "            value: 0.018182745349064267\r\n",
      "            unit: cm-2 s-1 TeV-1\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: false\r\n",
      "            error: 0.003026327991562108\r\n",
      "        -   name: reference\r\n",
      "            value: 5.054833602905273e-05\r\n",
      "            unit: TeV\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n",
      "        -   name: alpha\r\n",
      "            value: 1.652368617859867\r\n",
      "            unit: ''\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: false\r\n",
      "            error: 0.05762513693893088\r\n",
      "        -   name: beta\r\n",
      "            value: 0.03921700077803329\r\n",
      "            unit: ''\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: false\r\n",
      "            error: 0.00521472221220211\r\n",
      "    spatial:\r\n",
      "        type: PointSpatialModel\r\n",
      "        frame: icrs\r\n",
      "        parameters:\r\n",
      "        -   name: lon_0\r\n",
      "            value: 83.63310241699219\r\n",
      "            unit: deg\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n",
      "        -   name: lat_0\r\n",
      "            value: 22.019899368286133\r\n",
      "            unit: deg\r\n",
      "            min: -90.0\r\n",
      "            max: 90.0\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n",
      "-   type: FoVBackgroundModel\r\n",
      "    datasets_names:\r\n",
      "    - Fermi-LAT\r\n",
      "    spectral:\r\n",
      "        type: PowerLawNormSpectralModel\r\n",
      "        parameters:\r\n",
      "        -   name: norm\r\n",
      "            value: 1.3004625872247901\r\n",
      "            unit: ''\r\n",
      "            min: 0.0\r\n",
      "            max: .nan\r\n",
      "            frozen: false\r\n",
      "            error: 0.07512322002655547\r\n",
      "        -   name: tilt\r\n",
      "            value: 0.0\r\n",
      "            unit: ''\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n",
      "        -   name: reference\r\n",
      "            value: 1.0\r\n",
      "            unit: TeV\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n"
     ]
    }
   ],
   "source": [
    "!cat $GAMMAPY_DATA/fermi-3fhl-crab/Fermi-LAT-3FHL_models.yaml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Reading  different datasets\n",
    "\n",
    "\n",
    "### Fermi-LAT 3FHL: map dataset for 3D analysis\n",
    "For now we let's use the datasets serialization only to read the 3D `MapDataset` associated to Fermi-LAT 3FHL data and models."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:16.419108Z",
     "iopub.status.busy": "2020-11-19T14:16:16.416396Z",
     "iopub.status.idle": "2020-11-19T14:16:16.502404Z",
     "shell.execute_reply": "2020-11-19T14:16:16.501414Z"
    }
   },
   "outputs": [],
   "source": [
    "path = Path(\"$GAMMAPY_DATA/fermi-3fhl-crab\")\n",
    "filename = path / \"Fermi-LAT-3FHL_datasets.yaml\"\n",
    "\n",
    "datasets = Datasets.read(filename=filename)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:16.505450Z",
     "iopub.status.busy": "2020-11-19T14:16:16.504880Z",
     "iopub.status.idle": "2020-11-19T14:16:16.539226Z",
     "shell.execute_reply": "2020-11-19T14:16:16.540088Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Models\n",
      "\n",
      "Component 0: SkyModel\n",
      "\n",
      "  Name                      : Crab Nebula\n",
      "  Datasets names            : None\n",
      "  Spectral model type       : LogParabolaSpectralModel\n",
      "  Spatial  model type       : PointSpatialModel\n",
      "  Temporal model type       : \n",
      "  Parameters:\n",
      "    amplitude               :   1.82e-02  1 / (cm2 s TeV)\n",
      "    reference    (frozen)   :   0.000  TeV         \n",
      "    alpha                   :   1.652              \n",
      "    beta                    :   0.039              \n",
      "    lon_0        (frozen)   :  83.633  deg         \n",
      "    lat_0        (frozen)   :  22.020  deg         \n",
      "\n",
      "Component 1: FoVBackgroundModel\n",
      "\n",
      "  Name                      : Fermi-LAT-bkg\n",
      "  Datasets names            : ['Fermi-LAT']\n",
      "  Spectral model type       : PowerLawNormSpectralModel\n",
      "  Parameters:\n",
      "    norm                    :   1.300              \n",
      "    tilt         (frozen)   :   0.000              \n",
      "    reference    (frozen)   :   1.000  TeV         \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "models = Models.read(path / \"Fermi-LAT-3FHL_models.yaml\")\n",
    "print(models)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We get the Crab model in order to share it with the other datasets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:16.545989Z",
     "iopub.status.busy": "2020-11-19T14:16:16.544791Z",
     "iopub.status.idle": "2020-11-19T14:16:16.547184Z",
     "shell.execute_reply": "2020-11-19T14:16:16.547667Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SkyModel\n",
      "\n",
      "  Name                      : Crab Nebula\n",
      "  Datasets names            : None\n",
      "  Spectral model type       : LogParabolaSpectralModel\n",
      "  Spatial  model type       : PointSpatialModel\n",
      "  Temporal model type       : \n",
      "  Parameters:\n",
      "    amplitude               :   1.82e-02  1 / (cm2 s TeV)\n",
      "    reference    (frozen)   :   0.000  TeV         \n",
      "    alpha                   :   1.652              \n",
      "    beta                    :   0.039              \n",
      "    lon_0        (frozen)   :  83.633  deg         \n",
      "    lat_0        (frozen)   :  22.020  deg         \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(models[\"Crab Nebula\"])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### HESS-DL3: 1D ON/OFF dataset for spectral fitting\n",
    "\n",
    "The ON/OFF datasets can be read from PHA files following the [OGIP standards](https://heasarc.gsfc.nasa.gov/docs/heasarc/ofwg/docs/spectra/ogip_92_007/node5.html).\n",
    "We read the PHA files from each observation, and compute a stacked dataset for simplicity.\n",
    "Then the Crab spectral model previously defined is added to the dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:16.553317Z",
     "iopub.status.busy": "2020-11-19T14:16:16.551509Z",
     "iopub.status.idle": "2020-11-19T14:16:16.743227Z",
     "shell.execute_reply": "2020-11-19T14:16:16.742203Z"
    }
   },
   "outputs": [],
   "source": [
    "datasets_hess = Datasets()\n",
    "\n",
    "for obs_id in [23523, 23526]:\n",
    "    dataset = SpectrumDatasetOnOff.from_ogip_files(\n",
    "        f\"$GAMMAPY_DATA/joint-crab/spectra/hess/pha_obs{obs_id}.fits\"\n",
    "    )\n",
    "    datasets_hess.append(dataset)\n",
    "\n",
    "dataset_hess = datasets_hess.stack_reduce(name=\"HESS\")\n",
    "\n",
    "datasets.append(dataset_hess)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:16.748442Z",
     "iopub.status.busy": "2020-11-19T14:16:16.747337Z",
     "iopub.status.idle": "2020-11-19T14:16:16.749578Z",
     "shell.execute_reply": "2020-11-19T14:16:16.750069Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datasets\n",
      "--------\n",
      "\n",
      "Dataset 0: \n",
      "\n",
      "  Type       : MapDataset\n",
      "  Name       : Fermi-LAT\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "Dataset 1: \n",
      "\n",
      "  Type       : SpectrumDatasetOnOff\n",
      "  Name       : HESS\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(datasets)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### HAWC: 1D dataset for flux point fitting\n",
    "\n",
    "The HAWC flux point are taken from https://arxiv.org/pdf/1905.12518.pdf. Then these flux points are read from a pre-made FITS file and passed to a `FluxPointsDataset` together with the source spectral model.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:16.753806Z",
     "iopub.status.busy": "2020-11-19T14:16:16.753287Z",
     "iopub.status.idle": "2020-11-19T14:16:16.763449Z",
     "shell.execute_reply": "2020-11-19T14:16:16.763009Z"
    }
   },
   "outputs": [],
   "source": [
    "# read flux points from https://arxiv.org/pdf/1905.12518.pdf\n",
    "filename = \"$GAMMAPY_DATA/hawc_crab/HAWC19_flux_points.fits\"\n",
    "flux_points_hawc = FluxPoints.read(filename)\n",
    "dataset_hawc = FluxPointsDataset(data=flux_points_hawc, name=\"HAWC\")\n",
    "\n",
    "datasets.append(dataset_hawc)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:16.768016Z",
     "iopub.status.busy": "2020-11-19T14:16:16.766732Z",
     "iopub.status.idle": "2020-11-19T14:16:16.768988Z",
     "shell.execute_reply": "2020-11-19T14:16:16.769491Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datasets\n",
      "--------\n",
      "\n",
      "Dataset 0: \n",
      "\n",
      "  Type       : MapDataset\n",
      "  Name       : Fermi-LAT\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "Dataset 1: \n",
      "\n",
      "  Type       : SpectrumDatasetOnOff\n",
      "  Name       : HESS\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "Dataset 2: \n",
      "\n",
      "  Type       : FluxPointsDataset\n",
      "  Name       : HAWC\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(datasets)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Datasets serialization\n",
    "\n",
    "The `datasets` object contains each dataset previously defined. \n",
    "It can be saved on disk as datasets.yaml, models.yaml, and several data files specific to each dataset. Then the `datasets` can be rebuild later from these files."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:16.773035Z",
     "iopub.status.busy": "2020-11-19T14:16:16.772543Z",
     "iopub.status.idle": "2020-11-19T14:16:17.226670Z",
     "shell.execute_reply": "2020-11-19T14:16:17.227129Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "HDU 'MASK_FIT' not found\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/numpy/core/_asarray.py:83: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray\n",
      "  return array(a, dtype, copy=False, order=order)\n"
     ]
    }
   ],
   "source": [
    "path = Path(\"crab-3datasets\")\n",
    "path.mkdir(exist_ok=True)\n",
    "\n",
    "filename = path / \"crab_10GeV_100TeV_datasets.yaml\"\n",
    "\n",
    "datasets.write(filename, overwrite=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:17.232302Z",
     "iopub.status.busy": "2020-11-19T14:16:17.231813Z",
     "iopub.status.idle": "2020-11-19T14:16:17.381008Z",
     "shell.execute_reply": "2020-11-19T14:16:17.379808Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "datasets:\r\n",
      "- name: Fermi-LAT\r\n",
      "  type: MapDataset\r\n",
      "  filename: Fermi-LAT.fits\r\n",
      "- name: HESS\r\n",
      "  type: SpectrumDatasetOnOff\r\n",
      "  filename: pha_obsHESS.fits\r\n",
      "- name: HAWC\r\n",
      "  type: FluxPointsDataset\r\n",
      "  filename: HAWC.fits\r\n"
     ]
    }
   ],
   "source": [
    "!cat crab-3datasets/crab_10GeV_100TeV_datasets.yaml"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:17.386034Z",
     "iopub.status.busy": "2020-11-19T14:16:17.385339Z",
     "iopub.status.idle": "2020-11-19T14:16:17.701056Z",
     "shell.execute_reply": "2020-11-19T14:16:17.700465Z"
    }
   },
   "outputs": [],
   "source": [
    "datasets = Datasets.read(filename)\n",
    "datasets.models = models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:17.705871Z",
     "iopub.status.busy": "2020-11-19T14:16:17.704789Z",
     "iopub.status.idle": "2020-11-19T14:16:17.707097Z",
     "shell.execute_reply": "2020-11-19T14:16:17.707586Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datasets\n",
      "--------\n",
      "\n",
      "Dataset 0: \n",
      "\n",
      "  Type       : MapDataset\n",
      "  Name       : Fermi-LAT\n",
      "  Instrument : \n",
      "  Models     : ['Crab Nebula', 'Fermi-LAT-bkg']\n",
      "\n",
      "Dataset 1: \n",
      "\n",
      "  Type       : SpectrumDatasetOnOff\n",
      "  Name       : HESS\n",
      "  Instrument : \n",
      "  Models     : ['Crab Nebula']\n",
      "\n",
      "Dataset 2: \n",
      "\n",
      "  Type       : FluxPointsDataset\n",
      "  Name       : HAWC\n",
      "  Instrument : \n",
      "  Models     : ['Crab Nebula']\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(datasets)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Joint analysis\n",
    "\n",
    "We run the fit on the `Datasets` object that include a dataset for each instrument\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:17.713900Z",
     "iopub.status.busy": "2020-11-19T14:16:17.713401Z",
     "iopub.status.idle": "2020-11-19T14:16:21.027092Z",
     "shell.execute_reply": "2020-11-19T14:16:21.026305Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "HDU 'MASK_FIT' not found\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OptimizeResult\n",
      "\n",
      "\tbackend    : minuit\n",
      "\tmethod     : minuit\n",
      "\tsuccess    : True\n",
      "\tmessage    : Optimization terminated successfully.\n",
      "\tnfev       : 299\n",
      "\ttotal stat : -12695.04\n",
      "\n",
      "CPU times: user 3.3 s, sys: 11.4 ms, total: 3.32 s\n",
      "Wall time: 3.31 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "fit_joint = Fit(datasets)\n",
    "results_joint = fit_joint.run()\n",
    "print(results_joint)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's display only the parameters of the Crab spectral model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:21.033014Z",
     "iopub.status.busy": "2020-11-19T14:16:21.032523Z",
     "iopub.status.idle": "2020-11-19T14:16:21.036385Z",
     "shell.execute_reply": "2020-11-19T14:16:21.035953Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabolaSpectralModel\n",
      "\n",
      "   name     value         unit      min max frozen   error  \n",
      "--------- ---------- -------------- --- --- ------ ---------\n",
      "amplitude 3.8982e-03 cm-2 s-1 TeV-1 nan nan  False 3.119e-04\n",
      "reference 5.0548e-05            TeV nan nan   True 0.000e+00\n",
      "    alpha 1.2561e+00                nan nan  False 1.746e-02\n",
      "     beta 6.1981e-02                nan nan  False 9.775e-04\n"
     ]
    }
   ],
   "source": [
    "crab_spec = datasets[0].models[\"Crab Nebula\"].spectral_model\n",
    "print(crab_spec)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can compute flux points for Fermi-LAT and HESS datasets in order plot them together with the HAWC flux point."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:21.044155Z",
     "iopub.status.busy": "2020-11-19T14:16:21.041532Z",
     "iopub.status.idle": "2020-11-19T14:16:27.501160Z",
     "shell.execute_reply": "2020-11-19T14:16:27.500317Z"
    }
   },
   "outputs": [],
   "source": [
    "# compute Fermi-LAT and HESS flux points\n",
    "energy_edges = MapAxis.from_energy_bounds(\"10 GeV\", \"2 TeV\", nbin=5).edges\n",
    "\n",
    "flux_points_fermi = FluxPointsEstimator(\n",
    "    energy_edges=energy_edges, source=\"Crab Nebula\"\n",
    ").run([datasets[\"Fermi-LAT\"]])\n",
    "\n",
    "\n",
    "energy_edges = MapAxis.from_bounds(\n",
    "    1, 15, nbin=6, interp=\"log\", unit=\"TeV\"\n",
    ").edges\n",
    "flux_points_hess = FluxPointsEstimator(\n",
    "    energy_edges=energy_edges, source=\"Crab Nebula\"\n",
    ").run([datasets[\"HESS\"]])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now, Let's plot the Crab spectrum fitted and the flux points of each instrument.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-19T14:16:27.529615Z",
     "iopub.status.busy": "2020-11-19T14:16:27.526807Z",
     "iopub.status.idle": "2020-11-19T14:16:28.372205Z",
     "shell.execute_reply": "2020-11-19T14:16:28.371295Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/modeling/models/spectral.py:405: MatplotlibDeprecationWarning: The 'nonposx' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_xscale(\"log\", nonposx=\"clip\")\n",
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/modeling/models/spectral.py:406: MatplotlibDeprecationWarning: The 'nonposy' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_yscale(\"log\", nonposy=\"clip\")\n",
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/estimators/flux_point.py:667: MatplotlibDeprecationWarning: The 'nonposx' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_xscale(\"log\", nonposx=\"clip\")\n",
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/estimators/flux_point.py:668: MatplotlibDeprecationWarning: The 'nonposy' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_yscale(\"log\", nonposy=\"clip\")\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<matplotlib.legend.Legend at 0x7f18a32bb6d8>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# display spectrum and flux points\n",
    "energy_range = [0.01, 120] * u.TeV\n",
    "plt.figure(figsize=(8, 6))\n",
    "ax = crab_spec.plot(energy_range=energy_range, energy_power=2, label=\"Model\")\n",
    "crab_spec.plot_error(ax=ax, energy_range=energy_range, energy_power=2)\n",
    "flux_points_fermi.plot(ax=ax, energy_power=2, label=\"Fermi-LAT\")\n",
    "flux_points_hess.plot(ax=ax, energy_power=2, label=\"HESS\")\n",
    "flux_points_hawc.plot(ax=ax, energy_power=2, label=\"HAWC\")\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
