{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "<div class=\"alert alert-info\">\n",
    "\n",
    "**This is a fixed-text formatted version of a Jupyter notebook**\n",
    "\n",
    "- Try online [![Binder](https://static.mybinder.org/badge.svg)](https://mybinder.org/v2/gh/gammapy/gammapy-webpage/master?urlpath=lab/tree/analysis_mwl.ipynb)\n",
    "- You can contribute with your own notebooks in this\n",
    "[GitHub repository](https://github.com/gammapy/gammapy/tree/master/docs/tutorials).\n",
    "- **Source files:**\n",
    "[analysis_mwl.ipynb](../_static/notebooks/analysis_mwl.ipynb) |\n",
    "[analysis_mwl.py](../_static/notebooks/analysis_mwl.py)\n",
    "</div>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Joint modeling, fitting, and serialization\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Prerequisites\n",
    "\n",
    "- Handling of Fermi-LAT data with gammapy [see the corresponding tutorial](fermi_lat.ipynb)\n",
    "- Knowledge of spectral analysis to produce 1D On-Off datasets, [see the following tutorial](spectrum_analysis.ipynb)\n",
    "- Using flux points to directly fit a model (without forward-folding)  [see the SED fitting tutorial](sed_fitting.ipynb)\n",
    "\n",
    "## Context\n",
    "\n",
    "Some science studies require to combine heterogeneous data from various instruments to extract physical informations. In particular, it is often useful to add flux measurements of a source at different energies to an analysis to better constrain the wide-band spectral parameters. This can be done using a joint fit of heterogeneous datasets.\n",
    " \n",
    "**Objectives: Constrain the spectral parameters of the gamma-ray emission from the Crab nebula between 10 GeV and 100 TeV, using a 3D Fermi dataset, a H.E.S.S. reduced spectrum and HAWC flux points.**\n",
    "\n",
    "## Proposed approach\n",
    "\n",
    "This tutorial illustrates how to perfom a joint modeling and fitting of the Crab Nebula spectrum using different datasets.\n",
    "The spectral parameters are optimized by combining a 3D analysis of Fermi-LAT data, a ON/OFF spectral analysis of HESS data, and flux points from HAWC.\n",
    "\n",
    "In this tutorial we are going to use pre-made datasets. We prepared maps of the Crab region as seen by Fermi-LAT using the same event selection than the [3FHL catalog](https://arxiv.org/abs/1702.00664) (7 years of data with energy from 10 GeV to 2 TeV). For the HESS ON/OFF analysis we used two observations from the [first public data release](https://arxiv.org/abs/1810.04516) with a significant signal from energy of about 600 GeV to 10 TeV. These observations have an offset of 0.5° and a zenith angle of 45-48°. The HAWC flux points data are taken from a [recent analysis](https://arxiv.org/pdf/1905.12518.pdf) based on 2.5 years of data with energy between 300 Gev and 300 TeV. \n",
    "\n",
    "## The setup\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:47.375495Z",
     "iopub.status.busy": "2020-11-04T00:30:47.374969Z",
     "iopub.status.idle": "2020-11-04T00:30:48.520177Z",
     "shell.execute_reply": "2020-11-04T00:30:48.519086Z"
    }
   },
   "outputs": [],
   "source": [
    "from astropy import units as u\n",
    "import matplotlib.pyplot as plt\n",
    "from gammapy.modeling import Fit\n",
    "from gammapy.modeling.models import Models\n",
    "from gammapy.datasets import Datasets, FluxPointsDataset, SpectrumDatasetOnOff\n",
    "from gammapy.estimators import FluxPoints, FluxPointsEstimator\n",
    "from gammapy.maps import MapAxis\n",
    "from pathlib import Path"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Data and models files\n",
    "\n",
    "\n",
    "The datasets serialization produce YAML files listing the datasets and models. In the following cells we show an example containning only the Fermi-LAT dataset and the Crab model. \n",
    "\n",
    "Fermi-LAT-3FHL_datasets.yaml:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:48.530852Z",
     "iopub.status.busy": "2020-11-04T00:30:48.525100Z",
     "iopub.status.idle": "2020-11-04T00:30:48.677027Z",
     "shell.execute_reply": "2020-11-04T00:30:48.676518Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "datasets:\r\n",
      "- name: Fermi-LAT\r\n",
      "  type: MapDataset\r\n",
      "  filename: Fermi-LAT-3FHL_data_Fermi-LAT.fits\r\n"
     ]
    }
   ],
   "source": [
    "!cat $GAMMAPY_DATA/fermi-3fhl-crab/Fermi-LAT-3FHL_datasets.yaml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We used as model a point source with a log-parabola spectrum. The initial parameters were taken from the latest Fermi-LAT catalog [4FGL](https://arxiv.org/abs/1902.10045), then we have re-optimized the spectral parameters for our dataset in the 10 GeV - 2 TeV energy range (fixing the source position).\n",
    "\n",
    "Fermi-LAT-3FHL_models.yaml:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:48.685250Z",
     "iopub.status.busy": "2020-11-04T00:30:48.684745Z",
     "iopub.status.idle": "2020-11-04T00:30:48.829358Z",
     "shell.execute_reply": "2020-11-04T00:30:48.829915Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "components:\r\n",
      "-   name: Crab Nebula\r\n",
      "    type: SkyModel\r\n",
      "    spectral:\r\n",
      "        type: LogParabolaSpectralModel\r\n",
      "        parameters:\r\n",
      "        -   name: amplitude\r\n",
      "            value: 0.018182745349064267\r\n",
      "            unit: cm-2 s-1 TeV-1\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: false\r\n",
      "            error: 0.003026327991562108\r\n",
      "        -   name: reference\r\n",
      "            value: 5.054833602905273e-05\r\n",
      "            unit: TeV\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n",
      "        -   name: alpha\r\n",
      "            value: 1.652368617859867\r\n",
      "            unit: ''\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: false\r\n",
      "            error: 0.05762513693893088\r\n",
      "        -   name: beta\r\n",
      "            value: 0.03921700077803329\r\n",
      "            unit: ''\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: false\r\n",
      "            error: 0.00521472221220211\r\n",
      "    spatial:\r\n",
      "        type: PointSpatialModel\r\n",
      "        frame: icrs\r\n",
      "        parameters:\r\n",
      "        -   name: lon_0\r\n",
      "            value: 83.63310241699219\r\n",
      "            unit: deg\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n",
      "        -   name: lat_0\r\n",
      "            value: 22.019899368286133\r\n",
      "            unit: deg\r\n",
      "            min: -90.0\r\n",
      "            max: 90.0\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n",
      "-   type: FoVBackgroundModel\r\n",
      "    datasets_names:\r\n",
      "    - Fermi-LAT\r\n",
      "    spectral:\r\n",
      "        type: PowerLawNormSpectralModel\r\n",
      "        parameters:\r\n",
      "        -   name: norm\r\n",
      "            value: 1.3004625872247901\r\n",
      "            unit: ''\r\n",
      "            min: 0.0\r\n",
      "            max: .nan\r\n",
      "            frozen: false\r\n",
      "            error: 0.07512322002655547\r\n",
      "        -   name: tilt\r\n",
      "            value: 0.0\r\n",
      "            unit: ''\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n",
      "        -   name: reference\r\n",
      "            value: 1.0\r\n",
      "            unit: TeV\r\n",
      "            min: .nan\r\n",
      "            max: .nan\r\n",
      "            frozen: true\r\n",
      "            error: 0.0\r\n"
     ]
    }
   ],
   "source": [
    "!cat $GAMMAPY_DATA/fermi-3fhl-crab/Fermi-LAT-3FHL_models.yaml"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Reading  different datasets\n",
    "\n",
    "\n",
    "### Fermi-LAT 3FHL: map dataset for 3D analysis\n",
    "For now we let's use the datasets serialization only to read the 3D `MapDataset` associated to Fermi-LAT 3FHL data and models."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:48.839576Z",
     "iopub.status.busy": "2020-11-04T00:30:48.835971Z",
     "iopub.status.idle": "2020-11-04T00:30:48.917588Z",
     "shell.execute_reply": "2020-11-04T00:30:48.916334Z"
    }
   },
   "outputs": [],
   "source": [
    "path = Path(\"$GAMMAPY_DATA/fermi-3fhl-crab\")\n",
    "filename = path / \"Fermi-LAT-3FHL_datasets.yaml\"\n",
    "\n",
    "datasets = Datasets.read(filename=filename)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:48.925959Z",
     "iopub.status.busy": "2020-11-04T00:30:48.920634Z",
     "iopub.status.idle": "2020-11-04T00:30:48.955022Z",
     "shell.execute_reply": "2020-11-04T00:30:48.955900Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Models\n",
      "\n",
      "Component 0: SkyModel\n",
      "\n",
      "  Name                      : Crab Nebula\n",
      "  Datasets names            : None\n",
      "  Spectral model type       : LogParabolaSpectralModel\n",
      "  Spatial  model type       : PointSpatialModel\n",
      "  Temporal model type       : \n",
      "  Parameters:\n",
      "    amplitude               :   1.82e-02  1 / (cm2 s TeV)\n",
      "    reference    (frozen)   :   0.000  TeV         \n",
      "    alpha                   :   1.652              \n",
      "    beta                    :   0.039              \n",
      "    lon_0        (frozen)   :  83.633  deg         \n",
      "    lat_0        (frozen)   :  22.020  deg         \n",
      "\n",
      "Component 1: FoVBackgroundModel\n",
      "\n",
      "  Name                      : Fermi-LAT-bkg\n",
      "  Datasets names            : ['Fermi-LAT']\n",
      "  Spectral model type       : PowerLawNormSpectralModel\n",
      "  Parameters:\n",
      "    norm                    :   1.300              \n",
      "    tilt         (frozen)   :   0.000              \n",
      "    reference    (frozen)   :   1.000  TeV         \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "models = Models.read(path / \"Fermi-LAT-3FHL_models.yaml\")\n",
    "print(models)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We get the Crab model in order to share it with the other datasets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:48.962022Z",
     "iopub.status.busy": "2020-11-04T00:30:48.961111Z",
     "iopub.status.idle": "2020-11-04T00:30:48.963223Z",
     "shell.execute_reply": "2020-11-04T00:30:48.963742Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "SkyModel\n",
      "\n",
      "  Name                      : Crab Nebula\n",
      "  Datasets names            : None\n",
      "  Spectral model type       : LogParabolaSpectralModel\n",
      "  Spatial  model type       : PointSpatialModel\n",
      "  Temporal model type       : \n",
      "  Parameters:\n",
      "    amplitude               :   1.82e-02  1 / (cm2 s TeV)\n",
      "    reference    (frozen)   :   0.000  TeV         \n",
      "    alpha                   :   1.652              \n",
      "    beta                    :   0.039              \n",
      "    lon_0        (frozen)   :  83.633  deg         \n",
      "    lat_0        (frozen)   :  22.020  deg         \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(models[\"Crab Nebula\"])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### HESS-DL3: 1D ON/OFF dataset for spectral fitting\n",
    "\n",
    "The ON/OFF datasets can be read from PHA files following the [OGIP standards](https://heasarc.gsfc.nasa.gov/docs/heasarc/ofwg/docs/spectra/ogip_92_007/node5.html).\n",
    "We read the PHA files from each observation, and compute a stacked dataset for simplicity.\n",
    "Then the Crab spectral model previously defined is added to the dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:48.968909Z",
     "iopub.status.busy": "2020-11-04T00:30:48.967286Z",
     "iopub.status.idle": "2020-11-04T00:30:49.168882Z",
     "shell.execute_reply": "2020-11-04T00:30:49.167895Z"
    }
   },
   "outputs": [],
   "source": [
    "datasets_hess = Datasets()\n",
    "\n",
    "for obs_id in [23523, 23526]:\n",
    "    dataset = SpectrumDatasetOnOff.from_ogip_files(\n",
    "        f\"$GAMMAPY_DATA/joint-crab/spectra/hess/pha_obs{obs_id}.fits\"\n",
    "    )\n",
    "    datasets_hess.append(dataset)\n",
    "\n",
    "dataset_hess = datasets_hess.stack_reduce(name=\"HESS\")\n",
    "\n",
    "datasets.append(dataset_hess)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:49.174455Z",
     "iopub.status.busy": "2020-11-04T00:30:49.173221Z",
     "iopub.status.idle": "2020-11-04T00:30:49.175731Z",
     "shell.execute_reply": "2020-11-04T00:30:49.176242Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datasets\n",
      "--------\n",
      "\n",
      "Dataset 0: \n",
      "\n",
      "  Type       : MapDataset\n",
      "  Name       : Fermi-LAT\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "Dataset 1: \n",
      "\n",
      "  Type       : SpectrumDatasetOnOff\n",
      "  Name       : HESS\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(datasets)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### HAWC: 1D dataset for flux point fitting\n",
    "\n",
    "The HAWC flux point are taken from https://arxiv.org/pdf/1905.12518.pdf. Then these flux points are read from a pre-made FITS file and passed to a `FluxPointsDataset` together with the source spectral model.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:49.179986Z",
     "iopub.status.busy": "2020-11-04T00:30:49.179502Z",
     "iopub.status.idle": "2020-11-04T00:30:49.189985Z",
     "shell.execute_reply": "2020-11-04T00:30:49.189521Z"
    }
   },
   "outputs": [],
   "source": [
    "# read flux points from https://arxiv.org/pdf/1905.12518.pdf\n",
    "filename = \"$GAMMAPY_DATA/hawc_crab/HAWC19_flux_points.fits\"\n",
    "flux_points_hawc = FluxPoints.read(filename)\n",
    "dataset_hawc = FluxPointsDataset(data=flux_points_hawc, name=\"HAWC\")\n",
    "\n",
    "datasets.append(dataset_hawc)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:49.194445Z",
     "iopub.status.busy": "2020-11-04T00:30:49.193325Z",
     "iopub.status.idle": "2020-11-04T00:30:49.195657Z",
     "shell.execute_reply": "2020-11-04T00:30:49.196144Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datasets\n",
      "--------\n",
      "\n",
      "Dataset 0: \n",
      "\n",
      "  Type       : MapDataset\n",
      "  Name       : Fermi-LAT\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "Dataset 1: \n",
      "\n",
      "  Type       : SpectrumDatasetOnOff\n",
      "  Name       : HESS\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "Dataset 2: \n",
      "\n",
      "  Type       : FluxPointsDataset\n",
      "  Name       : HAWC\n",
      "  Instrument : \n",
      "  Models     : \n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(datasets)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Datasets serialization\n",
    "\n",
    "The `datasets` object contains each dataset previously defined. \n",
    "It can be saved on disk as datasets.yaml, models.yaml, and several data files specific to each dataset. Then the `datasets` can be rebuild later from these files."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:49.199656Z",
     "iopub.status.busy": "2020-11-04T00:30:49.198984Z",
     "iopub.status.idle": "2020-11-04T00:30:49.635530Z",
     "shell.execute_reply": "2020-11-04T00:30:49.635919Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "HDU 'MASK_FIT' not found\n",
      "/usr/share/miniconda/envs/gammapy-dev/lib/python3.7/site-packages/numpy/core/_asarray.py:83: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray\n",
      "  return array(a, dtype, copy=False, order=order)\n"
     ]
    }
   ],
   "source": [
    "path = Path(\"crab-3datasets\")\n",
    "path.mkdir(exist_ok=True)\n",
    "\n",
    "filename = path / \"crab_10GeV_100TeV_datasets.yaml\"\n",
    "\n",
    "datasets.write(filename, overwrite=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:49.640164Z",
     "iopub.status.busy": "2020-11-04T00:30:49.639709Z",
     "iopub.status.idle": "2020-11-04T00:30:49.790170Z",
     "shell.execute_reply": "2020-11-04T00:30:49.789666Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "datasets:\r\n",
      "- name: Fermi-LAT\r\n",
      "  type: MapDataset\r\n",
      "  filename: Fermi-LAT.fits\r\n",
      "- name: HESS\r\n",
      "  type: SpectrumDatasetOnOff\r\n",
      "  filename: pha_obsHESS.fits\r\n",
      "- name: HAWC\r\n",
      "  type: FluxPointsDataset\r\n",
      "  filename: HAWC.fits\r\n"
     ]
    }
   ],
   "source": [
    "!cat crab-3datasets/crab_10GeV_100TeV_datasets.yaml"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:49.796328Z",
     "iopub.status.busy": "2020-11-04T00:30:49.795859Z",
     "iopub.status.idle": "2020-11-04T00:30:50.093506Z",
     "shell.execute_reply": "2020-11-04T00:30:50.092756Z"
    }
   },
   "outputs": [],
   "source": [
    "datasets = Datasets.read(filename)\n",
    "datasets.models = models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:50.097156Z",
     "iopub.status.busy": "2020-11-04T00:30:50.096679Z",
     "iopub.status.idle": "2020-11-04T00:30:50.100179Z",
     "shell.execute_reply": "2020-11-04T00:30:50.099749Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datasets\n",
      "--------\n",
      "\n",
      "Dataset 0: \n",
      "\n",
      "  Type       : MapDataset\n",
      "  Name       : Fermi-LAT\n",
      "  Instrument : \n",
      "  Models     : ['Crab Nebula', 'Fermi-LAT-bkg']\n",
      "\n",
      "Dataset 1: \n",
      "\n",
      "  Type       : SpectrumDatasetOnOff\n",
      "  Name       : HESS\n",
      "  Instrument : \n",
      "  Models     : ['Crab Nebula']\n",
      "\n",
      "Dataset 2: \n",
      "\n",
      "  Type       : FluxPointsDataset\n",
      "  Name       : HAWC\n",
      "  Instrument : \n",
      "  Models     : ['Crab Nebula']\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print(datasets)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Joint analysis\n",
    "\n",
    "We run the fit on the `Datasets` object that include a dataset for each instrument\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:50.106270Z",
     "iopub.status.busy": "2020-11-04T00:30:50.105784Z",
     "iopub.status.idle": "2020-11-04T00:30:53.928222Z",
     "shell.execute_reply": "2020-11-04T00:30:53.928638Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "HDU 'MASK_FIT' not found\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OptimizeResult\n",
      "\n",
      "\tbackend    : minuit\n",
      "\tmethod     : minuit\n",
      "\tsuccess    : True\n",
      "\tmessage    : Optimization terminated successfully.\n",
      "\tnfev       : 305\n",
      "\ttotal stat : -12695.04\n",
      "\n",
      "CPU times: user 3.82 s, sys: 4.29 ms, total: 3.82 s\n",
      "Wall time: 3.82 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "fit_joint = Fit(datasets)\n",
    "results_joint = fit_joint.run()\n",
    "print(results_joint)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's display only the parameters of the Crab spectral model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:53.935098Z",
     "iopub.status.busy": "2020-11-04T00:30:53.934603Z",
     "iopub.status.idle": "2020-11-04T00:30:53.938175Z",
     "shell.execute_reply": "2020-11-04T00:30:53.937717Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LogParabolaSpectralModel\n",
      "\n",
      "   name     value         unit      min max frozen   error  \n",
      "--------- ---------- -------------- --- --- ------ ---------\n",
      "amplitude 3.8966e-03 cm-2 s-1 TeV-1 nan nan  False 3.119e-04\n",
      "reference 5.0548e-05            TeV nan nan   True 0.000e+00\n",
      "    alpha 1.2560e+00                nan nan  False 1.747e-02\n",
      "     beta 6.1986e-02                nan nan  False 9.778e-04\n"
     ]
    }
   ],
   "source": [
    "crab_spec = datasets[0].models[\"Crab Nebula\"].spectral_model\n",
    "print(crab_spec)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can compute flux points for Fermi-LAT and HESS datasets in order plot them together with the HAWC flux point."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:30:53.944093Z",
     "iopub.status.busy": "2020-11-04T00:30:53.943587Z",
     "iopub.status.idle": "2020-11-04T00:31:00.465911Z",
     "shell.execute_reply": "2020-11-04T00:31:00.464937Z"
    }
   },
   "outputs": [],
   "source": [
    "# compute Fermi-LAT and HESS flux points\n",
    "energy_edges = MapAxis.from_energy_bounds(\"10 GeV\", \"2 TeV\", nbin=5).edges\n",
    "\n",
    "flux_points_fermi = FluxPointsEstimator(\n",
    "    energy_edges=energy_edges, source=\"Crab Nebula\"\n",
    ").run([datasets[\"Fermi-LAT\"]])\n",
    "\n",
    "\n",
    "energy_edges = MapAxis.from_bounds(\n",
    "    1, 15, nbin=6, interp=\"log\", unit=\"TeV\"\n",
    ").edges\n",
    "flux_points_hess = FluxPointsEstimator(\n",
    "    energy_edges=energy_edges, source=\"Crab Nebula\"\n",
    ").run([datasets[\"HESS\"]])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now, Let's plot the Crab spectrum fitted and the flux points of each instrument.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-04T00:31:00.493890Z",
     "iopub.status.busy": "2020-11-04T00:31:00.493337Z",
     "iopub.status.idle": "2020-11-04T00:31:01.340411Z",
     "shell.execute_reply": "2020-11-04T00:31:01.339286Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(array([0.00698646, 0.02015874, 0.05816603, 0.16783227, 0.48426319]), array([0.01186753, 0.03424258, 0.09880353, 0.2850877 , 0.82259195]))\n",
      "(array([0.25892541, 0.41036912, 0.65039123, 1.03080063, 1.6337089 ,\n",
      "       2.58925412]), array([0.32596778, 0.51662412, 0.81879405, 1.29770111, 2.05671765,\n",
      "       3.25967781]))\n",
      "None\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/modeling/models/spectral.py:415: MatplotlibDeprecationWarning: The 'nonposx' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_xscale(\"log\", nonposx=\"clip\")\n",
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/modeling/models/spectral.py:416: MatplotlibDeprecationWarning: The 'nonposy' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_yscale(\"log\", nonposy=\"clip\")\n",
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/estimators/flux_point.py:668: MatplotlibDeprecationWarning: The 'nonposx' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_xscale(\"log\", nonposx=\"clip\")\n",
      "/home/runner/work/gammapy-docs/gammapy-docs/gammapy/gammapy/estimators/flux_point.py:669: MatplotlibDeprecationWarning: The 'nonposy' parameter of __init__() has been renamed 'nonpositive' since Matplotlib 3.3; support for the old name will be dropped two minor releases later.\n",
      "  ax.set_yscale(\"log\", nonposy=\"clip\")\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<matplotlib.legend.Legend at 0x7f5c1e90bac8>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# display spectrum and flux points\n",
    "energy_range = [0.01, 120] * u.TeV\n",
    "plt.figure(figsize=(8, 6))\n",
    "ax = crab_spec.plot(energy_range=energy_range, energy_power=2, label=\"Model\")\n",
    "crab_spec.plot_error(ax=ax, energy_range=energy_range, energy_power=2)\n",
    "flux_points_fermi.plot(ax=ax, energy_power=2, label=\"Fermi-LAT\")\n",
    "flux_points_hess.plot(ax=ax, energy_power=2, label=\"HESS\")\n",
    "flux_points_hawc.plot(ax=ax, energy_power=2, label=\"HAWC\")\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  },
  "nbsphinx": {
   "orphan": true
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
